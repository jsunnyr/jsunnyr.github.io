<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>mysql_basic | Hexo</title><meta name="description" content="[!NOTE]在MySQL中,schema和database是同义词.CREATE SCHEMA和CREATE DATABASE是等效的.但是其他的数据库产品(几乎所有数据库)有所不同.在oracle数据库产品中,schema是database的一部分.表示the tables and other objects owned by a single user.   [!NOTE]https:&#x2F;&#x2F;"><meta property="og:type" content="article"><meta property="og:title" content="mysql_basic"><meta property="og:url" content="http://jsunnyr.github.io/2020/01/07/mysql-basic/index.html"><meta property="og:site_name" content="InSo"><meta property="og:description" content="[!NOTE]在MySQL中,schema和database是同义词.CREATE SCHEMA和CREATE DATABASE是等效的.但是其他的数据库产品(几乎所有数据库)有所不同.在oracle数据库产品中,schema是database的一部分.表示the tables and other objects owned by a single user.   [!NOTE]https:&#x2F;&#x2F;"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2020-01-07T02:10:16.000Z"><meta property="article:modified_time" content="2021-12-05T12:32:55.845Z"><meta property="article:author" content="susu"><meta property="article:tag" content="Knowledge"><meta property="article:tag" content="MySQL"><meta name="twitter:card" content="summary"><link rel="canonical" href="http://jsunnyr.github.io/2020/01/07/mysql-basic/index.html"><link rel="alternate" href="/atom.xml" title="InSo" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/jsunnyr" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">素丶素丶丶</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">wodetian</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Earth</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="Search"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="Type something..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav menu-highlight"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">Home</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">Archives</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon"></i> <span class="menu-title">Categories</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">Tags</span></a></li><li class="menu-item menu-item-books"><a href="/books"><i class="icon icon-book-fill"></i> <span class="menu-title">Books</span></a></li><li class="menu-item menu-item-links"><a href="/links"><i class="icon icon-friendship"></i> <span class="menu-title">Links</span></a></li><li class="menu-item menu-item-about"><a href="/about"><i class="icon icon-cup-fill"></i> <span class="menu-title">About</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/jsunnyr" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li><li><a href="http://weibo.com/jsunnyr" target="_blank" title="Weibo" data-toggle="tooltip" data-placement="top"><i class="icon icon-weibo"></i></a></li><li><a href="https://twitter.com/iwebued" target="_blank" title="Twitter" data-toggle="tooltip" data-placement="top"><i class="icon icon-twitter"></i></a></li><li><a href="https://www.behance.net/jsunnyr" target="_blank" title="Behance" data-toggle="tooltip" data-placement="top"><i class="icon icon-behance"></i></a></li><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">Board</h3><div class="widget-body"><div id="board"><div class="content"><p>✍一✍!</p></div></div></div></div><div class="widget"><h3 class="widget-title">Categories</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/BSD/">BSD</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Certification/">Certification</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Database/">Database</a><span class="category-list-count">13</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Database/Oracle/">Oracle</a><span class="category-list-count">13</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/JS/">JS</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/">Kernel</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Knowledge/">Knowledge</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">20</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Network/">Network</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OS/">OS</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/OS/ubuntu/">ubuntu</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/OpenBSD/">OpenBSD</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/OpenStack/">OpenStack</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Oracle/">Oracle</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Oracle/Roadmap/">Roadmap</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Outline/">Outline</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Programming/">Programming</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Programming/CMD/">CMD</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Programming/Powershell/">Powershell</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Security/">Security</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Windows/">Windows</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%96%87%E7%AB%A0%E5%88%86%E7%B1%BB/">文章分类</a><span class="category-list-count">1</span></li></ul></div></div><div class="widget"><h3 class="widget-title">Tags</h3><div class="widget-body"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/BSD/" rel="tag">BSD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CMD/" rel="tag">CMD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Certification/" rel="tag">Certification</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Emacs/" rel="tag">Emacs</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Experience/" rel="tag">Experience</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hardware/" rel="tag">Hardware</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kernel/" rel="tag">Kernel</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Knowledge/" rel="tag">Knowledge</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">23</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Network/" rel="tag">Network</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OS/" rel="tag">OS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Official-doc/" rel="tag">Official doc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenBSD/" rel="tag">OpenBSD</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenStack/" rel="tag">OpenStack</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle/" rel="tag">Oracle</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Outline/" rel="tag">Outline</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Perl/" rel="tag">Perl</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Powershell/" rel="tag">Powershell</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Programming/" rel="tag">Programming</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Roadmap/" rel="tag">Roadmap</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ruby/" rel="tag">Ruby</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQL/" rel="tag">SQL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Security/" rel="tag">Security</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UNIX/" rel="tag">UNIX</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asm/" rel="tag">asm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iptables/" rel="tag">iptables</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/logstash/" rel="tag">logstash</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/" rel="tag">npm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/package-management/" rel="tag">package-management</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/service-management/" rel="tag">service-management</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/user-management/" rel="tag">user-management</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xls2csv/" rel="tag">xls2csv</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E7%AB%A0%E6%A0%87%E7%AD%BE/" rel="tag">文章标签</a><span class="tag-list-count">1</span></li></ul></div></div><div class="widget"><h3 class="widget-title">Tag Cloud</h3><div class="widget-body tagcloud"><a href="/tags/BSD/" style="font-size:13px">BSD</a> <a href="/tags/CMD/" style="font-size:13px">CMD</a> <a href="/tags/Certification/" style="font-size:13px">Certification</a> <a href="/tags/Emacs/" style="font-size:13px">Emacs</a> <a href="/tags/Experience/" style="font-size:13px">Experience</a> <a href="/tags/Hardware/" style="font-size:13px">Hardware</a> <a href="/tags/Kernel/" style="font-size:13px">Kernel</a> <a href="/tags/Knowledge/" style="font-size:13.5px">Knowledge</a> <a href="/tags/Linux/" style="font-size:14px">Linux</a> <a href="/tags/MySQL/" style="font-size:13.67px">MySQL</a> <a href="/tags/Network/" style="font-size:13px">Network</a> <a href="/tags/OS/" style="font-size:13.17px">OS</a> <a href="/tags/Official-doc/" style="font-size:13px">Official doc</a> <a href="/tags/OpenBSD/" style="font-size:13.33px">OpenBSD</a> <a href="/tags/OpenStack/" style="font-size:13px">OpenStack</a> <a href="/tags/Oracle/" style="font-size:13.83px">Oracle</a> <a href="/tags/Outline/" style="font-size:13.17px">Outline</a> <a href="/tags/Perl/" style="font-size:13px">Perl</a> <a href="/tags/Powershell/" style="font-size:13px">Powershell</a> <a href="/tags/Programming/" style="font-size:13px">Programming</a> <a href="/tags/Roadmap/" style="font-size:13px">Roadmap</a> <a href="/tags/Ruby/" style="font-size:13px">Ruby</a> <a href="/tags/SQL/" style="font-size:13px">SQL</a> <a href="/tags/Security/" style="font-size:13px">Security</a> <a href="/tags/UNIX/" style="font-size:13px">UNIX</a> <a href="/tags/asm/" style="font-size:13px">asm</a> <a href="/tags/git/" style="font-size:13px">git</a> <a href="/tags/iptables/" style="font-size:13.17px">iptables</a> <a href="/tags/logstash/" style="font-size:13px">logstash</a> <a href="/tags/npm/" style="font-size:13px">npm</a> <a href="/tags/package-management/" style="font-size:13px">package-management</a> <a href="/tags/service-management/" style="font-size:13px">service-management</a> <a href="/tags/user-management/" style="font-size:13.17px">user-management</a> <a href="/tags/xls2csv/" style="font-size:13px">xls2csv</a> <a href="/tags/%E6%96%87%E7%AB%A0%E6%A0%87%E7%AD%BE/" style="font-size:13px">文章标签</a></div></div><div class="widget"><h3 class="widget-title">Archive</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a><span class="archive-list-count">42</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a><span class="archive-list-count">51</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a><span class="archive-list-count">18</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a><span class="archive-list-count">1</span></li></ul></div></div><div class="widget"><h3 class="widget-title">Recent Posts</h3><div class="widget-body"><ul class="recent-post-list list-unstyled"><li><div class="item-thumb"><a href="/2021/12/07/oracle-11-role-privileges-%E8%A7%92%E8%89%B2%E4%B8%8E%E6%9D%83%E9%99%90/" class="thumb"><span class="thumb-image thumb-none"></span></a></div><div class="item-inner"><p class="item-category"></p><p class="item-title"><a href="/2021/12/07/oracle-11-role-privileges-%E8%A7%92%E8%89%B2%E4%B8%8E%E6%9D%83%E9%99%90/" class="title">(no title)</a></p><p class="item-date"><time datetime="2021-12-07T05:18:03.215Z" itemprop="datePublished">2021-12-07</time></p></div></li><li><div class="item-thumb"><a href="/2021/12/05/kvm-related/" class="thumb"><span class="thumb-image thumb-none"></span></a></div><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/%E6%96%87%E7%AB%A0%E5%88%86%E7%B1%BB/">文章分类</a></p><p class="item-title"><a href="/2021/12/05/kvm-related/" class="title">Virt-manager</a></p><p class="item-date"><time datetime="2021-12-05T13:57:53.764Z" itemprop="datePublished">2021-12-05</time></p></div></li><li><div class="item-thumb"><a href="/2021/12/05/windows-powershell-01-basic/" class="thumb"><span class="thumb-image thumb-none"></span></a></div><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/Programming/">Programming</a><i class="icon icon-angle-right"></i><a class="category-link" href="/categories/Programming/Powershell/">Powershell</a></p><p class="item-title"><a href="/2021/12/05/windows-powershell-01-basic/" class="title">Powershell Programming</a></p><p class="item-date"><time datetime="2021-12-05T13:56:02.722Z" itemprop="datePublished">2021-12-05</time></p></div></li><li><div class="item-thumb"><a href="/2021/12/05/windows-powershell-book/" class="thumb"><span class="thumb-image thumb-none"></span></a></div><div class="item-inner"><p class="item-category"></p><p class="item-title"><a href="/2021/12/05/windows-powershell-book/" class="title">(no title)</a></p><p class="item-date"><time datetime="2021-12-05T12:32:55.905Z" itemprop="datePublished">2021-12-05</time></p></div></li><li><div class="item-thumb"><a href="/2021/12/05/sdn-vxlan/" class="thumb"><span class="thumb-image thumb-none"></span></a></div><div class="item-inner"><p class="item-category"></p><p class="item-title"><a href="/2021/12/05/sdn-vxlan/" class="title">(no title)</a></p><p class="item-date"><time datetime="2021-12-05T12:32:55.895Z" itemprop="datePublished">2021-12-05</time></p></div></li></ul></div></div></div></aside><main class="main" role="main"><div class="content"><article id="post-mysql-basic" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">mysql_basic</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2020/01/07/mysql-basic/" class="article-date"><time datetime="2020-01-07T02:10:16.000Z" itemprop="datePublished">2020-01-07</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/Knowledge/">Knowledge</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/Knowledge/" rel="tag">Knowledge</a>, <a class="article-tag-link-link" href="/tags/MySQL/" rel="tag">MySQL</a> </span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2020/01/07/mysql-basic/#comments" class="article-comment-link">Comments</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><blockquote><p>[!NOTE]<br>在MySQL中,schema和database是同义词.<br>CREATE SCHEMA和CREATE DATABASE是等效的.<br>但是其他的数据库产品(几乎所有数据库)有所不同.在oracle数据库产品中,schema是database的一部分.<br>表示the tables and other objects owned by a single user.</p></blockquote><blockquote><p>[!NOTE]<br><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/">https://dev.mysql.com/doc/</a><br><a target="_blank" rel="noopener" href="https://pymysql.readthedocs.io/en/latest/">https://pymysql.readthedocs.io/en/latest/</a></p></blockquote><h1 id="MySQL-related-command"><a href="#MySQL-related-command" class="headerlink" title="MySQL-related command"></a>MySQL-related command</h1><blockquote><p>mysql is case-insensitive</p></blockquote><ol><li>可用反引号（`）为标识符（库名、表名、字段名、索引、别名）包裹，以避免与关键字重名！中文也可以作为标识符！</li><li>每个库目录存在一个保存当前数据库的选项文件db.opt。</li><li>注释：<br>单行注释 # 注释内容<br>多行注释 /* 注释内容 */<br>单行注释 – 注释内容 (标准SQL注释风格，要求双破折号后加一空格符（空格、TAB、换行等）)</li><li>模式通配符：<br>_ 任意单个字符<br>% 任意多个字符，甚至包括零字符<br>单引号需要进行转义 &#39;</li><li>CMD命令行内的语句结束符可以为 “;”, “\G”, “\g”，仅影响显示结果。其他地方还是用分号结束。delimiter 可修改当前对话的语句结束符。</li><li>SQL对大小写不敏感</li><li>清除已有语句：\c</li></ol><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- connection over TCP/IP</span></span><br><span class="line">mysql <span class="operator">-</span>h server_ip <span class="operator">-</span>Pport <span class="operator">-</span>uroot <span class="operator">-</span>p</span><br><span class="line"><span class="comment">-- connection over UNIX Socket</span></span><br><span class="line">mysql <span class="operator">-</span>S <span class="operator">/</span>data<span class="operator">/</span>mysql<span class="operator">/</span>mysql.sock <span class="operator">-</span>uroot <span class="operator">-</span>p</span><br><span class="line"></span><br><span class="line">mysqld <span class="comment">--verbose --help</span></span><br><span class="line">mysqladmin version status proc</span><br><span class="line">mysqladmin variables extended<span class="operator">-</span>status processlist</span><br><span class="line">mysql <span class="operator">-</span>e &quot;check table db_name.tb_name quick&quot;</span><br><span class="line">mysqlshow</span><br><span class="line">mysqladmin <span class="operator">-</span>u root password &quot;new_password&quot;</span><br><span class="line">mysqladmin <span class="operator">-</span>u USERNAME <span class="operator">-</span>h HOSTNAME password <span class="string">&#x27;NEW_PASS&#x27;</span> <span class="operator">-</span>p</span><br><span class="line">mysqldumpslow  <span class="operator">-</span>s  c  <span class="operator">-</span>t  <span class="number">20</span>  <span class="number">233</span>SS1<span class="operator">-</span>slow.log</span><br><span class="line"></span><br><span class="line">\s;</span><br><span class="line">status;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- engine-related</span></span><br><span class="line"><span class="keyword">show</span> engine ENGINE_NAME &#123;logs<span class="operator">|</span>status&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- variable-related</span></span><br><span class="line"><span class="comment">-- 系统变量</span></span><br><span class="line"><span class="keyword">set</span> @<span class="variable">@global</span>.validate_password_length<span class="operator">=</span><span class="number">1</span>,@<span class="variable">@global</span>.validate_password_low_case<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line"><span class="keyword">set</span> names charset_name;</span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@global</span>.sql_mode;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 用户自定义变量</span></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@var</span>_name:<span class="operator">=</span><span class="keyword">value</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@var</span>_name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 时间函数</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> unix_timestamp() <span class="keyword">into</span> <span class="variable">@didi</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> from_unixtime(<span class="variable">@didi</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+</span></span><br><span class="line"><span class="operator">|</span> from_unixtime(<span class="variable">@didi</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2019</span><span class="number">-12</span><span class="number">-20</span> <span class="number">15</span>:<span class="number">23</span>:<span class="number">35</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- user-related</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> 用户权限相关数据保存在mysql数据库的usertb_name中，所以也可以直接对其进行操作</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建用户</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;ip&#x27;</span> IDETIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line">    <span class="operator">-</span> 必须拥有mysql数据库的全局<span class="keyword">CREATE</span> <span class="keyword">USER</span>权限，或拥有<span class="keyword">INSERT</span>权限。</span><br><span class="line">    <span class="operator">-</span> 只能创建用户，不能赋予权限。</span><br><span class="line">    <span class="operator">-</span> 用户名，注意引号：如 <span class="string">&#x27;user_name&#x27;</span>@<span class="string">&#x27;192.168.1.1&#x27;</span></span><br><span class="line">    <span class="operator">-</span> 密码也需引号，纯数字密码也要加引号</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> user_name@<span class="string">&#x27;%&#x27;</span> identified <span class="keyword">by</span> password ACCOUNT LOCK<span class="operator">/</span>UNLOCK;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 设置密码</span></span><br><span class="line"><span class="keyword">SET</span> PASSWORD <span class="operator">=</span> PASSWORD(<span class="string">&#x27;密码&#x27;</span>)  <span class="comment">-- 为当前用户设置密码</span></span><br><span class="line"><span class="keyword">SET</span> PASSWORD <span class="keyword">FOR</span> 用户名 <span class="operator">=</span> PASSWORD(<span class="string">&#x27;密码&#x27;</span>) <span class="comment">-- 为指定用户设置密码</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 重命名用户</span></span><br><span class="line">rename <span class="keyword">user</span> user_name <span class="keyword">TO</span> new_user_name;</span><br><span class="line">rename <span class="keyword">user</span> user_name<span class="variable">@ip</span>_addr <span class="keyword">TO</span> new_username<span class="variable">@new</span>_ip_addr;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除用户</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;ip&#x27;</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> mysql.user <span class="keyword">where</span> Host<span class="operator">=</span><span class="string">&#x27;192.168.1.4&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改用户</span></span><br><span class="line">RENAME <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;ip&#x27;</span> <span class="keyword">to</span> <span class="string">&#x27;new_username&#x27;</span>@<span class="string">&#x27;ip&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改密码</span></span><br><span class="line"><span class="keyword">SET</span> password <span class="keyword">FOR</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;ip&#x27;</span> <span class="operator">=</span> Password(<span class="string">&#x27;new_password&#x27;</span>);</span><br><span class="line"># mysql5<span class="number">.7</span>之前</span><br><span class="line">mysql<span class="operator">&gt;</span> update mysql.user <span class="keyword">set</span> password<span class="operator">=</span>password(<span class="string">&#x27;123456&#x27;</span>) <span class="keyword">where</span> <span class="keyword">user</span><span class="operator">=</span><span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"># mysql5<span class="number">.7</span>之后</span><br><span class="line">mysql<span class="operator">&gt;</span> update mysql.user <span class="keyword">set</span> authentication_string<span class="operator">=</span>password(<span class="string">&#x27;123456&#x27;</span>) <span class="keyword">where</span> <span class="keyword">user</span><span class="operator">=</span><span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">mysql<span class="operator">&gt;</span> flush privileges;</span><br><span class="line"></span><br><span class="line"><span class="keyword">Alter</span> <span class="keyword">user</span> UserName<span class="variable">@ip</span>_addr identified <span class="keyword">by</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> Host,<span class="keyword">User</span>,Grant_priv <span class="keyword">from</span> mysql.user;]</span><br><span class="line"></span><br><span class="line"><span class="operator">&gt;</span> [Privileges Provided <span class="keyword">by</span> MySQL](https:<span class="operator">/</span><span class="operator">/</span>dev.mysql.com<span class="operator">/</span>doc<span class="operator">/</span>refman<span class="operator">/</span><span class="number">5.7</span><span class="operator">/</span>en<span class="operator">/</span>privileges<span class="operator">-</span>provided.html)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查看权限</span></span><br><span class="line"><span class="keyword">show</span> grants;</span><br><span class="line"><span class="keyword">show</span> GRANTS <span class="keyword">FOR</span> <span class="string">&#x27;usernmae&#x27;</span>@<span class="string">&#x27;ip&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> grants <span class="keyword">for</span> <span class="built_in">current_user</span>();</span><br><span class="line"><span class="keyword">show</span> grants <span class="keyword">for</span> &quot;user&quot;@&quot;host&quot;;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 授权</span></span><br><span class="line"><span class="keyword">GRANT</span> 权限 <span class="keyword">ON</span> db_name.tb_name <span class="keyword">TO</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;ip&#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> db_name.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;host&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;testuser_pass&#x27;</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br><span class="line"></span><br><span class="line"><span class="operator">*</span> 取消授权</span><br><span class="line"><span class="keyword">REVOKE</span> 权限 <span class="keyword">FROM</span> db_name.tb_name <span class="keyword">FROM</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;ip&#x27;</span></span><br><span class="line"><span class="keyword">revoke</span> <span class="keyword">all</span> <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">from</span> &quot;username&quot;@&quot;localhost&quot;;</span><br><span class="line"><span class="keyword">revoke</span> <span class="keyword">select</span>  <span class="keyword">on</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">from</span> &quot;username&quot;@&quot;localhost&quot;;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改用户密码</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;ip_addr&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;new_password&#x27;</span>;</span><br><span class="line">update mysql.user <span class="keyword">set</span> password<span class="operator">=</span>password(<span class="string">&#x27;新密码&#x27;</span>) <span class="keyword">where</span> <span class="keyword">User</span><span class="operator">=</span>&quot;username&quot; <span class="keyword">and</span> Host<span class="operator">=</span>&quot;ip_addr&quot;;</span><br><span class="line"><span class="keyword">set</span> password <span class="keyword">for</span> user_name <span class="operator">=</span> new_password;</span><br><span class="line"><span class="keyword">set</span> password <span class="keyword">for</span> user_name <span class="operator">=</span> password(<span class="string">&#x27;new_password&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 口令失效</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> user_name<span class="variable">@ip</span>_addr password expire;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 权限列表</span></span><br><span class="line"><span class="keyword">ALL</span> [PRIVILEGES]    <span class="comment">-- 设置除GRANT OPTION之外的所有简单权限</span></span><br><span class="line"><span class="keyword">ALTER</span>   <span class="comment">-- 允许使用ALTER TABLE</span></span><br><span class="line"><span class="keyword">ALTER</span> ROUTINE   <span class="comment">-- 更改或取消已存储的子程序</span></span><br><span class="line"><span class="keyword">CREATE</span>  <span class="comment">-- 允许使用CREATE TABLE</span></span><br><span class="line"><span class="keyword">CREATE</span> ROUTINE  <span class="comment">-- 创建已存储的子程序</span></span><br><span class="line"><span class="keyword">CREATE</span> TEMPORARY TABLES     <span class="comment">-- 允许使用CREATE TEMPORARY TABLE</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span>     <span class="comment">-- 允许使用CREATE USER, DROP USER, RENAME USER和REVOKE ALL PRIVILEGES。</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span>     <span class="comment">-- 允许使用CREATE VIEW</span></span><br><span class="line"><span class="keyword">DELETE</span>  <span class="comment">-- 允许使用DELETE</span></span><br><span class="line"><span class="keyword">DROP</span>    <span class="comment">-- 允许使用DROP TABLE</span></span><br><span class="line"><span class="keyword">EXECUTE</span>     <span class="comment">-- 允许用户运行已存储的子程序</span></span><br><span class="line">FILE    <span class="comment">-- 允许使用SELECT...INTO OUTFILE和LOAD DATA INFILE</span></span><br><span class="line">INDEX   <span class="comment">-- 允许使用CREATE INDEX和DROP INDEX</span></span><br><span class="line"><span class="keyword">INSERT</span>  <span class="comment">-- 允许使用INSERT</span></span><br><span class="line">LOCK TABLES     <span class="comment">-- 允许对您拥有SELECT权限的表使用LOCK TABLES</span></span><br><span class="line">PROCESS     <span class="comment">-- 允许使用SHOW FULL PROCESSLIST</span></span><br><span class="line"><span class="keyword">REFERENCES</span>  <span class="comment">-- 未被实施</span></span><br><span class="line">RELOAD  <span class="comment">-- 允许使用FLUSH</span></span><br><span class="line">REPLICATION CLIENT  <span class="comment">-- 允许用户询问从属服务器或主服务器的地址</span></span><br><span class="line">REPLICATION SLAVE   <span class="comment">-- 用于复制型从属服务器（从主服务器中读取二进制日志事件）</span></span><br><span class="line"><span class="keyword">SELECT</span>  <span class="comment">-- 允许使用SELECT</span></span><br><span class="line"><span class="keyword">SHOW</span> DATABASES  <span class="comment">-- 显示所有数据库</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">VIEW</span>   <span class="comment">-- 允许使用SHOW CREATE VIEW</span></span><br><span class="line">SHUTDOWN    <span class="comment">-- 允许使用mysqladmin shutdown</span></span><br><span class="line">SUPER   <span class="comment">-- 允许使用CHANGE MASTER, KILL, PURGE MASTER LOGS和SET GLOBAL语句，mysqladmin debug命令；允许您连接（一次），即使已达到max_connections。</span></span><br><span class="line">UPDATE  <span class="comment">-- 允许使用UPDATE</span></span><br><span class="line">USAGE   <span class="comment">-- “无权限”的同义词</span></span><br><span class="line"><span class="keyword">GRANT</span> OPTION    <span class="comment">-- 允许授予权限</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- PLUGIN-related</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- install plugins</span></span><br><span class="line">INSTALL PLUGIN plugin_nbame SONAME <span class="string">&#x27;plugin_name&#x27;</span>;</span><br><span class="line"><span class="comment">-- uninstall plugin</span></span><br><span class="line">uninstall plugin plugin_name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- show-related</span></span><br><span class="line"><span class="keyword">show</span> warnings<span class="operator">/</span>variablels<span class="operator">/</span>status<span class="operator">/</span>engines<span class="operator">/</span><span class="keyword">collation</span>;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">procedure</span><span class="operator">/</span><span class="keyword">function</span><span class="operator">/</span><span class="keyword">table</span><span class="operator">/</span>database;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">procedure</span> status;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">procedure</span> proc_name;</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;lower_case_table_names&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> tables <span class="keyword">like</span> <span class="string">&#x27;regx&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> tb_name;</span><br><span class="line"><span class="keyword">desc</span> tb_name;</span><br><span class="line"><span class="keyword">describe</span> tb_name;</span><br><span class="line"><span class="keyword">show</span> COLUMNS <span class="keyword">FROM</span> tb_name;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">full</span> fields <span class="keyword">from</span> tb_name;</span><br><span class="line"><span class="keyword">show</span> INDEX <span class="keyword">FROM</span> tb_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">TABLE</span> STATUS <span class="keyword">FROM</span> db_name;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">TABLE</span> STATUS <span class="keyword">FROM</span> db_name <span class="keyword">LIKE</span> <span class="string">&#x27;pattern%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- SELECT-related</span></span><br><span class="line"><span class="keyword">SELECT</span> routine_schema, routine_name, sql_mode <span class="keyword">from</span> information_schema.routines;</span><br><span class="line"><span class="keyword">SELECT</span> event_object_schema, event_object_table, trigger_name, sql_mode <span class="keyword">from</span> nformation_schema.triggers;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">user</span>()<span class="operator">/</span>version()<span class="operator">/</span>database()<span class="operator">/</span><span class="built_in">CURRENT_DATE</span><span class="operator">/</span><span class="built_in">CURRENT_DATE</span>()<span class="operator">/</span>CURDATE()<span class="operator">/</span><span class="built_in">CURRENT_TIME</span><span class="operator">/</span><span class="built_in">CURRENT_TIME</span>()<span class="operator">/</span>CURTIME()<span class="operator">/</span>unix_timestamp()<span class="operator">/</span>last_insert_id()<span class="operator">/</span>connection_id()<span class="operator">/</span>uuid();</span><br><span class="line"><span class="keyword">select</span> <span class="number">4</span><span class="operator">+</span><span class="number">5</span>,ifnull(<span class="number">3</span>,<span class="number">2</span><span class="operator">/</span><span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span><span class="operator">|</span><span class="keyword">DISTINCT</span>] select_expr <span class="keyword">FROM</span> <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">WHERE</span> <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> [合计函数] <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">HAVING</span> <span class="operator">-</span><span class="operator">&gt;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="operator">-</span><span class="operator">&gt;</span> LIMIT</span><br><span class="line">a. select_expr</span><br><span class="line">    <span class="comment">-- 可以用 * 表示所有字段。</span></span><br><span class="line">        <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb;</span><br><span class="line">    <span class="comment">-- 可以使用表达式（计算公式、函数调用、字段也是个表达式）</span></span><br><span class="line">        <span class="keyword">select</span> stu, <span class="number">29</span><span class="operator">+</span><span class="number">25</span>, now() <span class="keyword">from</span> tb;</span><br><span class="line">    <span class="comment">-- 可以为每个列使用别名。适用于简化列标识，避免多个列标识符重复。</span></span><br><span class="line">        <span class="operator">-</span> 使用 <span class="keyword">as</span> 关键字，也可省略 as.</span><br><span class="line">        <span class="keyword">select</span> stu<span class="operator">+</span><span class="number">10</span> <span class="keyword">as</span> add10 <span class="keyword">from</span> tb;</span><br><span class="line">b. <span class="keyword">FROM</span> 子句</span><br><span class="line">    用于标识查询来源。</span><br><span class="line">    <span class="comment">-- 可以为表起别名。使用as关键字。</span></span><br><span class="line">        <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tb1 <span class="keyword">AS</span> tt, tb2 <span class="keyword">AS</span> bb;</span><br><span class="line">    <span class="comment">-- from子句后，可以同时出现多个表。</span></span><br><span class="line">        <span class="comment">-- 多个表会横向叠加到一起，而数据会形成一个笛卡尔积。</span></span><br><span class="line">        <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tb1, tb2;</span><br><span class="line">    <span class="comment">-- 向优化符提示如何选择索引</span></span><br><span class="line">        USE INDEX、IGNORE INDEX、FORCE INDEX</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table1 USE INDEX (key1,key2) <span class="keyword">WHERE</span> key1<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> key2<span class="operator">=</span><span class="number">2</span> <span class="keyword">AND</span> key3<span class="operator">=</span><span class="number">3</span>;</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table1 IGNORE INDEX (key3) <span class="keyword">WHERE</span> key1<span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> key2<span class="operator">=</span><span class="number">2</span> <span class="keyword">AND</span> key3<span class="operator">=</span><span class="number">3</span>;</span><br><span class="line">c. <span class="keyword">WHERE</span> 子句</span><br><span class="line">    <span class="comment">-- 从from获得的数据源中进行筛选。</span></span><br><span class="line">    <span class="comment">-- 整型1表示真，0表示假。</span></span><br><span class="line">    <span class="comment">-- 表达式由运算符和运算数组成。</span></span><br><span class="line">        <span class="comment">-- 运算数：变量（字段）、值、函数返回值</span></span><br><span class="line">        <span class="comment">-- 运算符：</span></span><br><span class="line">            <span class="operator">=</span>, <span class="operator">&lt;=&gt;</span>, <span class="operator">&lt;&gt;</span>, <span class="operator">!=</span>, <span class="operator">&lt;=</span>, <span class="operator">&lt;</span>, <span class="operator">&gt;=</span>, <span class="operator">&gt;</span>, <span class="operator">!</span>, <span class="operator">&amp;&amp;</span>, <span class="operator">||</span>,</span><br><span class="line">            <span class="keyword">in</span> (<span class="keyword">not</span>) <span class="keyword">null</span>, (<span class="keyword">not</span>) <span class="keyword">like</span>, (<span class="keyword">not</span>) <span class="keyword">in</span>, (<span class="keyword">not</span>) <span class="keyword">between</span> <span class="keyword">and</span>, <span class="keyword">is</span> (<span class="keyword">not</span>), <span class="keyword">and</span>, <span class="keyword">or</span>, <span class="keyword">not</span>, xor</span><br><span class="line">            <span class="keyword">is</span><span class="operator">/</span><span class="keyword">is</span> <span class="keyword">not</span> 加上ture<span class="operator">/</span><span class="literal">false</span><span class="operator">/</span><span class="literal">unknown</span>，检验某个值的真假</span><br><span class="line">            <span class="operator">&lt;=&gt;</span>与<span class="operator">&lt;&gt;</span>功能相同，<span class="operator">&lt;=&gt;</span>可用于<span class="keyword">null</span>比较</span><br><span class="line">d. <span class="keyword">GROUP</span> <span class="keyword">BY</span> 子句, 分组子句</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> 字段<span class="operator">/</span>别名 [排序方式]</span><br><span class="line">    分组后会进行排序。升序：<span class="keyword">ASC</span>，降序：<span class="keyword">DESC</span></span><br><span class="line">    以下[合计函数]需配合 <span class="keyword">GROUP</span> <span class="keyword">BY</span> 使用：</span><br><span class="line">    count 返回不同的非<span class="keyword">NULL</span>值数目  <span class="built_in">count</span>(<span class="operator">*</span>)、<span class="built_in">count</span>(字段)</span><br><span class="line">    sum 求和</span><br><span class="line">    max 求最大值</span><br><span class="line">    min 求最小值</span><br><span class="line">    avg 求平均值</span><br><span class="line">    group_concat 返回带有来自一个组的连接的非<span class="keyword">NULL</span>值的字符串结果。组内字符串连接。</span><br><span class="line">e. <span class="keyword">HAVING</span> 子句，条件子句</span><br><span class="line">    与 <span class="keyword">where</span> 功能、用法相同，执行时机不同。</span><br><span class="line">    <span class="keyword">where</span> 在开始时执行检测数据，对原数据进行过滤。</span><br><span class="line">    <span class="keyword">having</span> 对筛选出的结果再次进行过滤。</span><br><span class="line">    <span class="keyword">having</span> 字段必须是查询出来的，<span class="keyword">where</span> 字段必须是数据表存在的。</span><br><span class="line">    <span class="keyword">where</span> 不可以使用字段的别名，<span class="keyword">having</span> 可以。因为执行<span class="keyword">WHERE</span>代码时，可能尚未确定列值。</span><br><span class="line">    <span class="keyword">where</span> 不可以使用合计函数。一般需用合计函数才会用 <span class="keyword">having</span></span><br><span class="line">    <span class="keyword">SQL</span>标准要求<span class="keyword">HAVING</span>必须引用<span class="keyword">GROUP</span> <span class="keyword">BY</span>子句中的列或用于合计函数中的列。</span><br><span class="line">f. <span class="keyword">ORDER</span> <span class="keyword">BY</span> 子句，排序子句</span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> 排序字段<span class="operator">/</span>别名 排序方式 [,排序字段<span class="operator">/</span>别名 排序方式]...</span><br><span class="line">    升序：<span class="keyword">ASC</span>，降序：<span class="keyword">DESC</span></span><br><span class="line">    支持多个字段的排序。</span><br><span class="line">g. LIMIT 子句，限制结果数量子句</span><br><span class="line">    仅对处理好的结果进行数量限制。将处理好的结果的看作是一个集合，按照记录出现的顺序，索引从<span class="number">0</span>开始。</span><br><span class="line">    limit 起始位置, 获取条数</span><br><span class="line">    省略第一个参数，表示从索引<span class="number">0</span>开始。limit 获取条数</span><br><span class="line">h. <span class="keyword">DISTINCT</span>, <span class="keyword">ALL</span> 选项</span><br><span class="line">    <span class="keyword">distinct</span> 去除重复记录</span><br><span class="line">    默认为 <span class="keyword">all</span>, 全部记录</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- table-related</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_1( id <span class="type">int</span> , name <span class="type">varchar</span>(<span class="number">5</span>) );</span><br><span class="line"><span class="keyword">show</span> index <span class="keyword">from</span> tb_1;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_1 <span class="keyword">add</span> <span class="keyword">primary</span> key(id);</span><br><span class="line"><span class="keyword">create</span> index ind_name <span class="keyword">on</span> tb_1(id);</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">table</span> status <span class="keyword">like</span> <span class="string">&#x27;tb_1&#x27;</span>;</span><br><span class="line"><span class="keyword">SHOW</span> TABLES [ <span class="keyword">LIKE</span> <span class="string">&#x27;pattern&#x27;</span>];</span><br><span class="line"><span class="keyword">drop</span> index ind_name <span class="keyword">on</span> tb_1;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> tb_name;</span><br><span class="line">repair <span class="keyword">table</span> tb_name quick;</span><br><span class="line">analyze <span class="keyword">table</span> tb_name;</span><br><span class="line"><span class="keyword">SHOW</span> TABLES <span class="keyword">FROM</span> db_name;</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名;</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">TABLE</span> STATUS [<span class="keyword">FROM</span> db_name] [<span class="keyword">LIKE</span> <span class="string">&#x27;pattern&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 新建表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `tb_name`(</span><br><span class="line">    `field1` <span class="type">int</span> <span class="keyword">primary</span> key AUTO_INCREMENT <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    `field2` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">COLLATE</span> utf8mb4_general_ci,</span><br><span class="line">    `fieldLast`</span><br><span class="line">)ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_general_ci;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 表锁定只用于防止其它客户端进行不正当地读取和写入</span></span><br><span class="line"><span class="comment">-- MyISAM 支持表锁，InnoDB 支持行锁</span></span><br><span class="line"><span class="comment">-- 锁定</span></span><br><span class="line">    LOCK TABLES tbl_name [<span class="keyword">AS</span> alias]</span><br><span class="line"><span class="comment">-- 解锁</span></span><br><span class="line">    UNLOCK TABLES</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 其他建tb_name方式：  </span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">TABLE</span> new_tb_name <span class="keyword">LIKE</span> tb_name;(复制tb_name结构)  </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> new_tb_name <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">FROM</span> tb_name;(tb_name结构一致的前提下，插入所选数据)</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">TABLE</span> tb_name <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">TABLE</span> tb_name <span class="keyword">AS</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">FROM</span> tb_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 清空表</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> tb_name;(清空数据，保留tb_name结构)  </span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> tb_name;(清空数据，保留tb_name结构) </span><br><span class="line"><span class="comment">-- 区别</span></span><br><span class="line"><span class="operator">-</span> <span class="keyword">truncate</span> 是删除表再创建，<span class="keyword">delete</span> 是逐条删除</span><br><span class="line"><span class="operator">-</span> <span class="keyword">truncate</span> 重置auto_increment的值。而<span class="keyword">delete</span>不会</span><br><span class="line"><span class="operator">-</span> <span class="keyword">truncate</span> 不知道删除了几条，而<span class="keyword">delete</span>知道</span><br><span class="line"><span class="operator">-</span> 当被用于带分区的表时，<span class="keyword">truncate</span> 会保留分区</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> tb_name;(清空数据，删除tb_name)  </span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> tbl_name [<span class="keyword">WHERE</span> where_definition] [<span class="keyword">ORDER</span> <span class="keyword">BY</span> ...] [LIMIT row_count]</span><br><span class="line"><span class="operator">-</span> 按照条件删除。<span class="keyword">where</span></span><br><span class="line"><span class="operator">-</span> 指定删除的最多记录数。limit</span><br><span class="line"><span class="operator">-</span> 可以通过排序条件删除。<span class="keyword">order</span> <span class="keyword">by</span> <span class="operator">+</span> limit</span><br><span class="line"><span class="operator">-</span> 支持多表删除，使用类似连接语法。</span><br><span class="line"><span class="operator">-</span> <span class="keyword">delete</span> <span class="keyword">from</span> 需要删除数据多表<span class="number">1</span>，表<span class="number">2</span> <span class="keyword">using</span> 表连接操作 条件。</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 更改表名</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> old_tb_name RENAME <span class="keyword">TO</span> new_tb_name;</span><br><span class="line">RENAME <span class="keyword">TABLE</span> old_tb_name <span class="keyword">TO</span> new_tb_name;</span><br><span class="line">RENAME <span class="keyword">TABLE</span> 原表名 <span class="keyword">TO</span> 库名.表名 （可将表移动到另一个数据库）</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入信息</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tb_name <span class="keyword">VALUES</span>(字段<span class="number">1</span>，字段<span class="number">2</span>，<span class="string">&#x27;str&#x27;</span>, ...)；  </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tb_name <span class="keyword">VALUES</span>(字段<span class="number">1</span>(如果该字段自增，即使指定数字也无用，可写<span class="keyword">NULL</span>代替)，字段<span class="number">2</span>，<span class="string">&#x27;str&#x27;</span>, ...);  </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tb_name <span class="keyword">VALUES</span>( <span class="number">1</span>, <span class="string">&#x27;zhao&#x27;</span> ),( <span class="number">2</span>, <span class="string">&#x27;qian&#x27;</span> ),( <span class="number">3</span>, <span class="string">&#x27;sun&#x27;</span> );(插入多条数据)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- select语句获得的数据可以用insert插入</span></span><br><span class="line">可以省略对列的指定，要求 <span class="keyword">values</span> () 括号内，提供给了按照列顺序出现的所有字段的值。</span><br><span class="line">    或者使用<span class="keyword">set</span>语法。</span><br><span class="line">    <span class="keyword">INSERT</span> <span class="keyword">INTO</span> tbl_name <span class="keyword">SET</span> field<span class="operator">=</span><span class="keyword">value</span>,...；</span><br><span class="line">可以一次性使用多个值，采用(), (), ();的形式。</span><br><span class="line">    <span class="keyword">INSERT</span> <span class="keyword">INTO</span> tbl_name <span class="keyword">VALUES</span> (), (), ();</span><br><span class="line">可以在列值指定时，使用表达式。</span><br><span class="line">    <span class="keyword">INSERT</span> <span class="keyword">INTO</span> tbl_name <span class="keyword">VALUES</span> (field_value, <span class="number">10</span><span class="operator">+</span><span class="number">10</span>, now());</span><br><span class="line">可以使用一个特殊值 <span class="keyword">DEFAULT</span>，表示该列使用默认值。</span><br><span class="line">    <span class="keyword">INSERT</span> <span class="keyword">INTO</span> tbl_name <span class="keyword">VALUES</span> (field_value, <span class="keyword">DEFAULT</span>);</span><br><span class="line">可以通过一个查询的结果，作为需要插入的值。</span><br><span class="line">    <span class="keyword">INSERT</span> <span class="keyword">INTO</span> tbl_name <span class="keyword">SELECT</span> ...;</span><br><span class="line">可以指定在插入的值出现主键（或唯一索引）冲突时，更新其他非主键列的信息。</span><br><span class="line">    <span class="keyword">INSERT</span> <span class="keyword">INTO</span> tbl_name <span class="keyword">VALUES</span><span class="operator">/</span><span class="keyword">SET</span><span class="operator">/</span><span class="keyword">SELECT</span> <span class="keyword">ON</span> DUPLICATE KEY UPDATE 字段<span class="operator">=</span>值, …;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 更新信息</span></span><br><span class="line">UPDATE tb_name <span class="keyword">SET</span> `fieldN` <span class="operator">=</span> <span class="string">&#x27;new_value&#x27;</span> <span class="keyword">WHERE</span> Clause;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除字段</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tb_name <span class="keyword">DROP</span> `target_column_name`;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加字段</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tb_name <span class="keyword">ADD</span> `new_column_name` column_type_and_option;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 更改字段名</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tb_name CHANGE `target_col_name` `new_col_name` new_col_def;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tb_name CHANGE <span class="keyword">COLUMN</span>　`target_col_name` `new_col_name` new_col_def;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name modify `col_name` new_col_def;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tb_name MODIFY <span class="keyword">COLUMN</span> `target_col_name` new_def;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- db-related</span></span><br><span class="line"><span class="comment">-- 新建数据库</span></span><br><span class="line"><span class="keyword">create</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `db_name` <span class="keyword">DEFAULT</span> CHARSET utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_general_ci;</span><br><span class="line"><span class="keyword">CREATE</span> DATABASE `dada` <span class="comment">/*!40100 DEFAULT CHARACTER SET utf8mb4 */</span>;</span><br><span class="line"><span class="keyword">create</span> database zeze <span class="comment">/*!default character set utf8*/</span>;</span><br><span class="line"></span><br><span class="line"># <span class="keyword">alter</span><span class="operator">-</span>related</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name change old_col_name new_col_name col_definition;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> didi engine<span class="operator">=</span>innodb;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name <span class="keyword">drop</span> col_name;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name <span class="keyword">add</span> new_col_name col_definition;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name <span class="keyword">add</span> new_col_name <span class="keyword">First</span>;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name <span class="keyword">add</span> new_col_name after existed_col_name;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># <span class="built_in">trim</span>()</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">trim</span>(<span class="keyword">BOTH</span> <span class="string">&#x27;,&#x27;</span> <span class="keyword">FROM</span> &quot;,,haha,,&quot;);</span><br><span class="line"><span class="keyword">select</span> ... <span class="keyword">into</span> outfile <span class="string">&#x27;/tmp/db_xx_tb_yy&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># COMMENT <span class="operator">/</span> change</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> didi change id id <span class="type">int</span> comment <span class="string">&#x27;column:id&#x27;</span>;</span><br><span class="line"># modify</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> didi modify id <span class="type">int</span> comment <span class="string">&#x27;column:id&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> column_name, data_type, column_comment <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;didi&#x27;</span> <span class="keyword">and</span> table_schema<span class="operator">=</span><span class="string">&#x27;haha&#x27;</span> <span class="keyword">and</span> column_name <span class="keyword">like</span> <span class="string">&#x27;name%&#x27;</span>;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> zeze (id <span class="type">int</span>, name <span class="type">varchar</span>(<span class="number">20</span>)) COMMENT <span class="string">&#x27;table zeze&#x27;</span>;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> zeze (id <span class="type">int</span>, name <span class="type">varchar</span>(<span class="number">20</span>)) COMMENT<span class="operator">=</span><span class="string">&#x27;table zeze&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">table</span> status <span class="keyword">from</span> haha <span class="keyword">like</span> <span class="string">&#x27;didi&#x27;</span>\G;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">table</span> status <span class="keyword">where</span> name<span class="operator">=</span><span class="string">&#x27;didi&#x27;</span>\G;</span><br><span class="line"></span><br><span class="line"># log<span class="operator">-</span>related</span><br><span class="line"><span class="keyword">show</span> <span class="type">BINARY</span> LOGS;</span><br><span class="line"><span class="keyword">show</span> master logs;</span><br><span class="line"><span class="keyword">show</span> MASTER STATUS;</span><br><span class="line"><span class="keyword">show</span> BINLOG EVENTS <span class="keyword">IN</span> <span class="string">&#x27;二进制日志文件&#x27;</span> [<span class="keyword">FROM</span> <span class="string">&#x27;position&#x27;</span>];</span><br><span class="line">PURGE <span class="type">BINARY</span> LOGS <span class="keyword">TO</span> <span class="string">&#x27;日志文件&#x27;</span>;</span><br><span class="line">FLUSH LOGS;</span><br><span class="line">purge <span class="type">binary</span> logs before now()<span class="operator">-</span> <span class="type">interval</span> <span class="number">7</span> <span class="keyword">day</span>;</span><br><span class="line">purge <span class="type">binary</span> logs <span class="keyword">to</span> <span class="string">&#x27;bin_log_name&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">function</span> status [<span class="keyword">like</span> <span class="keyword">pattern</span>];</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">function</span> 函数名字;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">function</span> fun_name ...;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">function</span> fun_name;</span><br><span class="line"># 使用函数</span><br><span class="line"><span class="keyword">select</span> 函数名(实参列表);</span><br><span class="line"></span><br><span class="line"># perfromance</span><br><span class="line"># performance<span class="operator">-</span>related</span><br><span class="line"><span class="keyword">show</span> status <span class="keyword">like</span> <span class="string">&#x27;innodb_row_%&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;query%&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;innodb_doublewrite&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;innodb_data_file%&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;innodb_file%&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;innodb_temp%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"># 回收undo段的线程</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%purge%%&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;max_heap_table_size&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;tmp_table_size&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%tmpdir%&#x27;</span>;</span><br><span class="line"><span class="keyword">show</span> status <span class="keyword">like</span> <span class="string">&#x27;created_tmp%&#x27;</span>;</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"># 添加列</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name名 <span class="keyword">add</span> 列名 类型</span><br><span class="line"># 删除列</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name名 <span class="keyword">drop</span> <span class="keyword">column</span> 列名</span><br><span class="line"># 修改列</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name名 modify <span class="keyword">column</span> 列名 类型;  <span class="comment">-- 类型</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name名 change 原列名 新列名 类型; <span class="comment">-- 列名，类型</span></span><br><span class="line">  </span><br><span class="line"># 添加主键</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name名 <span class="keyword">add</span> <span class="keyword">primary</span> key(列名);</span><br><span class="line"># 删除主键</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name名 <span class="keyword">drop</span> <span class="keyword">primary</span> key;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name名  modify  列名 <span class="type">int</span>, <span class="keyword">drop</span> <span class="keyword">primary</span> key;</span><br><span class="line"></span><br><span class="line"># 添加外键</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 从tb_name <span class="keyword">add</span> <span class="keyword">constraint</span> 外键名称（形如</span><br><span class="line">FK_从tb_name_主tb_name） <span class="keyword">foreign</span> key 从tb_name(外键字段) <span class="keyword">references</span> 主tb_name(主键字段);</span><br><span class="line"># 删除外键</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_name名 <span class="keyword">drop</span> <span class="keyword">foreign</span> key 外键名称</span><br><span class="line">  </span><br><span class="line"># 修改默认值</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl <span class="keyword">ALTER</span> i <span class="keyword">SET</span> <span class="keyword">DEFAULT</span> <span class="number">1000</span>;</span><br><span class="line"># 删除默认值</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl <span class="keyword">ALTER</span> i <span class="keyword">DROP</span> <span class="keyword">DEFAULT</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、条件</span><br><span class="line"> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">where</span> id <span class="operator">&gt;</span> <span class="number">1</span> <span class="keyword">and</span> name <span class="operator">!=</span> <span class="string">&#x27;alex&#x27;</span> <span class="keyword">and</span> num <span class="operator">=</span> <span class="number">12</span>;</span><br><span class="line"> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">where</span> id <span class="keyword">between</span> <span class="number">5</span> <span class="keyword">and</span> <span class="number">16</span>;</span><br><span class="line"> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">where</span> id <span class="keyword">in</span> (<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>)</span><br><span class="line"> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">where</span> id <span class="keyword">not</span> <span class="keyword">in</span> (<span class="number">11</span>,<span class="number">22</span>,<span class="number">33</span>)</span><br><span class="line"> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">where</span> id <span class="keyword">in</span> (<span class="keyword">select</span> nid <span class="keyword">from</span> tb_name)</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、通配符</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;ale%&#x27;</span>  <span class="operator">-</span> ale开头的所有（多个字符串）</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;ale_&#x27;</span>  <span class="operator">-</span> ale开头的所有（一个字符）</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、限制</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name limit <span class="number">5</span>;            <span class="operator">-</span> 前<span class="number">5</span>行</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name limit <span class="number">4</span>,<span class="number">5</span>;          <span class="operator">-</span> 从第<span class="number">4</span>行开始的<span class="number">5</span>行</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name limit <span class="number">5</span> <span class="keyword">offset</span> <span class="number">4</span>    <span class="operator">-</span> 从第<span class="number">4</span>行开始的<span class="number">5</span>行</span><br><span class="line"> </span><br><span class="line"><span class="number">4</span>、排序</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">order</span> <span class="keyword">by</span> 列 <span class="keyword">asc</span>              <span class="operator">-</span> 根据 “列” 从小到大排列</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">order</span> <span class="keyword">by</span> 列 <span class="keyword">desc</span>             <span class="operator">-</span> 根据 “列” 从大到小排列</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_name <span class="keyword">order</span> <span class="keyword">by</span> 列<span class="number">1</span> <span class="keyword">desc</span>,列<span class="number">2</span> <span class="keyword">asc</span>    <span class="operator">-</span> 根据 “列<span class="number">1</span>” 从大到小排列，如果相同则按列<span class="number">2</span>从小到大排序</span><br><span class="line"> </span><br><span class="line"><span class="number">5</span>、分组</span><br><span class="line">    <span class="keyword">select</span> num <span class="keyword">from</span> tb_name <span class="keyword">group</span> <span class="keyword">by</span> num</span><br><span class="line">    <span class="keyword">select</span> num,nid <span class="keyword">from</span> tb_name <span class="keyword">group</span> <span class="keyword">by</span> num,nid</span><br><span class="line">    <span class="keyword">select</span> num,nid <span class="keyword">from</span> tb_name  <span class="keyword">where</span> nid <span class="operator">&gt;</span> <span class="number">10</span> <span class="keyword">group</span> <span class="keyword">by</span> num,nid <span class="keyword">order</span> nid <span class="keyword">desc</span></span><br><span class="line">    <span class="keyword">select</span> num,nid,<span class="built_in">count</span>(<span class="operator">*</span>),<span class="built_in">sum</span>(score),<span class="built_in">max</span>(score),<span class="built_in">min</span>(score) <span class="keyword">from</span> tb_name <span class="keyword">group</span> <span class="keyword">by</span> num,nid</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">select</span> num <span class="keyword">from</span> tb_name <span class="keyword">group</span> <span class="keyword">by</span> num <span class="keyword">having</span> <span class="built_in">max</span>(id) <span class="operator">&gt;</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line"># <span class="operator">&gt;</span> 特别的</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> 必须在<span class="keyword">where</span>之后，<span class="keyword">order</span> <span class="keyword">by</span>之前</span><br><span class="line"> </span><br><span class="line"><span class="number">6</span>、连tb_name</span><br><span class="line">    无对应关系则不显示</span><br><span class="line">    <span class="keyword">select</span> A.num, A.name, B.name</span><br><span class="line">    <span class="keyword">from</span> A,B</span><br><span class="line">    <span class="keyword">Where</span> A.nid <span class="operator">=</span> B.nid</span><br><span class="line"> </span><br><span class="line">    无对应关系则不显示</span><br><span class="line">    <span class="keyword">select</span> A.num, A.name, B.name</span><br><span class="line">    <span class="keyword">from</span> A <span class="keyword">inner</span> <span class="keyword">join</span> B</span><br><span class="line">    <span class="keyword">on</span> A.nid <span class="operator">=</span> B.nid</span><br><span class="line"> </span><br><span class="line">    Atb_name所有显示，如果B中无对应关系，则值为<span class="keyword">null</span></span><br><span class="line">    <span class="keyword">select</span> A.num, A.name, B.name</span><br><span class="line">    <span class="keyword">from</span> A <span class="keyword">left</span> <span class="keyword">join</span> B</span><br><span class="line">    <span class="keyword">on</span> A.nid <span class="operator">=</span> B.nid</span><br><span class="line"> </span><br><span class="line">    Btb_name所有显示，如果B中无对应关系，则值为<span class="keyword">null</span></span><br><span class="line">    <span class="keyword">select</span> A.num, A.name, B.name</span><br><span class="line">    <span class="keyword">from</span> A <span class="keyword">right</span> <span class="keyword">join</span> B</span><br><span class="line">    <span class="keyword">on</span> A.nid <span class="operator">=</span> B.nid</span><br><span class="line"> </span><br><span class="line"><span class="number">7</span>、组合</span><br><span class="line">    组合，自动处理重合</span><br><span class="line">    <span class="keyword">select</span> nickname</span><br><span class="line">    <span class="keyword">from</span> A</span><br><span class="line">    <span class="keyword">union</span></span><br><span class="line">    <span class="keyword">select</span> name</span><br><span class="line">    <span class="keyword">from</span> B</span><br><span class="line"> </span><br><span class="line">    组合，不处理重合</span><br><span class="line">    <span class="keyword">select</span> nickname</span><br><span class="line">    <span class="keyword">from</span> A</span><br><span class="line">    <span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">    <span class="keyword">select</span> name</span><br><span class="line">    <span class="keyword">from</span> B</span><br></pre></td></tr></table></figure><h1 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h1><ul><li>错误日志：<ul><li>log_error</li><li>log_warnings</li></ul></li><li>一般查询日志：<ul><li>general_log</li><li>general_log_file</li><li>log</li><li>log_output</li></ul></li><li>慢查询日志：<ul><li>log_output {TABLE|FILE|NONE}</li><li>long_query_time</li><li>log_slow_queries</li><li>slow_query_log</li><li>slow_query_log_file</li></ul></li><li>二进制日志:<ul><li>复制、即时点恢复</li><li>重放</li><li>二进制日志事件：<ul><li>基于语句：statement</li><li>基于行：row</li><li>混合方式：mixed</li></ul></li></ul></li></ul><h1 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a>通配符</h1><p>通配符的分类:<br>%百分号: tb_name示任何字符出现任意次数(可以是0次)。<br>下划线: tb_name示只能匹配单个字符,不能多也不能少,就是一个字符。</p><p>like操作符:<br>LIKE作用是指示mysql后面的搜索模式是利用通配符而不是直接相等匹配进行比较。</p><blockquote><p>%通配符可以匹配任意字符,但是不能匹配NULL<br>如果在使用like操作符时,后面的没有使用通用匹配符效果是和”=”一致的。</p></blockquote><p>原则：</p><ul><li>不要过度使用通配符。如果其他操作符能达到相同的目的，应该 使用其他操作符。</li><li>在确实需要使用通配符时，除非绝对有必要，否则不要把它们用 在搜索模式的开始处。把通配符置于搜索模式的开始处，搜索起 来是最慢的。</li><li>仔细注意通配符的位置。如果放错地方，可能不会返回想要的数.</li></ul><h1 id="查看字符集"><a href="#查看字符集" class="headerlink" title="查看字符集"></a>查看字符集</h1><p>show CHARSET;<br>show CHARACTER SET;<br>show COLLATION；</p><blockquote><p>UTF－8：一个汉字＝3个字节<br>GBK：一个汉字＝2个字节<br>从mysql 8.0开始，mysql默认的CHARSET已经不再是Latin1了，改为了utf8mb4（参考链接），并且默认的COLLATE也改为了utf8mb4_0900_ai_ci</p></blockquote><blockquote><p>设置COLLATE可以在示例级别、库级别、tb_name级别、列级别、以及SQL指定。实例级别的COLLATE设置就是mysql配置文件或启动指令中的collation_connection系统变量。</p></blockquote><blockquote><p>假设全都显示设置，那么优先级顺序是 SQL语句 &gt; 列级别设置 &gt; tb_name级别设置 &gt; 库级别设置 &gt; 实例级别设置。也就是说列上所指定的COLLATE可以覆盖tb_name上指定的COLLATE，tb_name上指定的COLLATE可以覆盖库级别的COLLATE。如果没有指定，则继承下一级的设置。即列上面没有指定COLLATE，则该列的COLLATE和tb_name上设置的一样。</p></blockquote><h1 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h1><ol><li>数值类型</li></ol><p>– a. 整型 ———-<br>类型 字节 范围（有符号位）<br>tinyint 1字节 -128 ~ 127 无符号位：0 ~ 255<br>smallint 2字节 -32768 ~ 32767<br>mediumint 3字节 -8388608 ~ 8388607<br>int 4字节<br>bigint 8字节<br>int(M) M表示总位数<br>- 默认存在符号位，unsigned 属性修改<br>- 显示宽度，如果某个数不够定义字段时设置的位数，则前面以0补填，zerofill 属性修改<br>例：int(5) 插入一个数’123’，补填后为’00123’<br>- 在满足要求的情况下，越小越好。<br>- 1表示bool值真，0表示bool值假。MySQL没有布尔类型，通过整型0和1表示。常用tinyint(1)表示布尔型。</p><p>– b. 浮点型 ———-<br>类型 字节 范围<br>float(单精度) 4字节<br>double(双精度) 8字节<br>浮点型既支持符号位 unsigned 属性，也支持显示宽度 zerofill 属性。<br>不同于整型，前后均会补填0.<br>定义浮点型时，需指定总位数和小数位数。<br>float(M, D) double(M, D)<br>M表示总位数，D表示小数位数。<br>M和D的大小会决定浮点数的范围。不同于整型的固定范围。<br>M既表示总位数（不包括小数点和正负号），也表示显示宽度（所有显示符号均包括）。<br>支持科学计数法表示。<br>浮点数表示近似值。</p><p>– c. 定点数 ———-<br>decimal – 可变长度<br>decimal(M, D) M也表示总位数，D表示小数位数。<br>保存一个精确的数值，不会发生数据的改变，不同于浮点数的四舍五入。<br>将浮点数转换为字符串来保存，每9位数字保存为4个字节。</p><ol start="2"><li>字符串类型</li></ol><p>– a. char, varchar ———-<br>char 定长字符串，速度快，但浪费空间<br>varchar 变长字符串，速度慢，但节省空间<br>M表示能存储的最大长度，此长度是字符数，非字节数。<br>不同的编码，所占用的空间不同。<br>char,最多255个字符，与编码无关。<br>varchar,最多65535字符，与编码有关。<br>一条有效记录最大不能超过65535个字节。<br>utf8 最大为21844个字符，gbk 最大为32766个字符，latin1 最大为65532个字符<br>varchar 是变长的，需要利用存储空间保存 varchar 的长度，如果数据小于255个字节，则采用一个字节来保存长度，反之需要两个字节来保存。<br>varchar 的最大有效长度由最大行大小和使用的字符集确定。<br>最大有效长度是65532字节，因为在varchar存字符串时，第一个字节是空的，不存在任何数据，然后还需两个字节来存放字符串的长度，所以有效长度是64432-1-2=65532字节。<br>例：若一个表定义为 CREATE TABLE tb(c1 int, c2 char(30), c3 varchar(N)) charset=utf8; 问N的最大值是多少？ 答：(65535-1-2-4-30*3)/3</p><p>– b. blob, text ———-<br>blob 二进制字符串（字节字符串）<br>tinyblob, blob, mediumblob, longblob<br>text 非二进制字符串（字符字符串）<br>tinytext, text, mediumtext, longtext<br>text 在定义时，不需要定义长度，也不会计算总长度。<br>text 类型在定义时，不可给default值</p><p>– c. binary, varbinary ———-<br>类似于char和varchar，用于保存二进制字符串，也就是保存字节字符串而非字符字符串。<br>char, varchar, text 对应 binary, varbinary, blob.</p><ol start="3"><li><p>日期时间类型<br>一般用整型保存时间戳，因为PHP可以很方便的将时间戳进行格式化。<br>datetime 8字节 日期及时间 1000-01-01 00:00:00 到 9999-12-31 23:59:59<br>date 3字节 日期 1000-01-01 到 9999-12-31<br>timestamp 4字节 时间戳 19700101000000 到 2038-01-19 03:14:07<br>time 3字节 时间 -838:59:59 到 838:59:59<br>year 1字节 年份 1901 - 2155<br>datetime YYYY-MM-DD hh:mm:ss<br>timestamp YY-MM-DD hh:mm:ss</p><pre><code>     YYYYMMDDhhmmss
     YYMMDDhhmmss
     YYYYMMDDhhmmss
     YYMMDDhhmmss
</code></pre><p>date YYYY-MM-DD</p><pre><code>     YY-MM-DD
     YYYYMMDD
     YYMMDD
     YYYYMMDD
     YYMMDD
</code></pre><p>time hh:mm:ss</p><pre><code>     hhmmss
     hhmmss
</code></pre><p>year YYYY</p><pre><code>     YY
     YYYY
     YY
</code></pre></li><li><p>枚举和集合</p></li></ol><p>– 枚举(enum) ———-<br>enum(val1, val2, val3…)<br>在已知的值中进行单选。最大数量为65535.<br>枚举值在保存时，以2个字节的整型(smallint)保存。每个枚举值，按保存的位置顺序，从1开始逐一递增。<br>表现为字符串类型，存储却是整型。<br>NULL值的索引是NULL。<br>空字符串错误值的索引值是0。</p><p>– 集合（set） ———-<br>set(val1, val2, val3…)<br>create table tab ( gender set(‘男’, ‘女’, ‘无’) );<br>insert into tab values (‘男, 女’);<br>最多可以有64个不同的成员。以bigint存储，共8个字节。采取位运算的形式。<br>当创建表时，SET成员值的尾部空格将自动被删除。</p><h1 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h1><ol><li>PRIMARY 主键<ul><li>能唯一标识记录的字段，可以作为主键。</li><li>一个表只能有一个主键。</li><li>主键具有唯一性。</li><li>声明字段时，用 primary key 标识。<br>也可以在字段列表之后声明<pre><code>  例：create table tab ( id int, stu varchar(10), primary key (id));
</code></pre></li><li>主键字段的值不能为null。</li><li>主键可以由多个字段共同组成。此时需要在字段列表后声明的方法。<br>例：create table tab ( id int, stu varchar(10), age int, primary key (stu, age));</li></ul></li><li>UNIQUE 唯一索引（唯一约束）<br>使得某字段的值也不能重复。</li><li>NULL 约束<br>null不是数据类型，是列的一个属性。<br>表示当前列是否可以为null，表示什么都没有。<br>null, 允许为空。默认。<br>not null, 不允许为空。<br>insert into tab values (null, ‘val’);<pre><code> -- 此时表示将第一个字段的值设为null, 取决于该字段是否允许为null
</code></pre></li><li>DEFAULT 默认值属性<br>当前字段的默认值。<br>insert into tab values (default, ‘val’); – 此时表示强制使用默认值。<br>create table tab ( add_time timestamp default current_timestamp );<pre><code> -- 表示将当前时间的时间戳设为默认值。
 current_date, current_time
</code></pre></li><li>AUTO_INCREMENT 自动增长约束<br>自动增长必须为索引（主键或unique）<br>只能存在一个字段为自动增长。<br>默认为1开始自动增长。可以通过表属性 auto_increment = x进行设置，或 alter table tbl auto_increment = x;</li><li>COMMENT 注释<br>例：create table tab ( id int ) comment ‘注释内容’;</li><li>FOREIGN KEY 外键约束<br>用于限制主表与从表数据完整性。<br>alter table t1 add constraint <code>t1_t2_fk</code> foreign key (t1_id) references t2(id);<pre><code> -- 将表t1的t1_id外键关联到表t2的id字段。
 -- 每个外键都有一个名字，可以通过 constraint 指定
</code></pre>存在外键的表，称之为从表（子表），外键指向的表，称之为主表（父表）。<br>作用：保持数据一致性，完整性，主要目的是控制存储在外键表（从表）中的数据。<br>MySQL中，可以对InnoDB引擎使用外键约束：<br>语法：<br>foreign key (外键字段） references 主表名 (关联字段) [主表记录删除时的动作] [主表记录更新时的动作]<br>此时需要检测一个从表的外键需要约束为主表的已存在的值。外键在没有关联的情况下，可以设置为null.前提是该外键列，没有not null。<br>可以不指定主表记录更改或更新时的动作，那么此时主表的操作被拒绝。<br>如果指定了 on update 或 on delete：在删除或更新时，有如下几个操作可以选择：<ol><li>cascade，级联操作。主表数据被更新（主键值更新），从表也被更新（外键值更新）。主表记录被删除，从表相关记录也被删除。</li><li>set null，设置为null。主表数据被更新（主键值更新），从表的外键被设置为null。主表记录被删除，从表相关记录外键被设置成null。但注意，要求该外键列，没有not null属性约束。</li><li>restrict，拒绝父表删除和更新。<br>注意，外键只被InnoDB存储引擎所支持。其他引擎是不支持的。</li></ol></li></ol><h1 id="授权相关"><a href="#授权相关" class="headerlink" title="授权相关"></a>授权相关</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">all</span> privileges  除<span class="keyword">grant</span>外的所有权限</span><br><span class="line"><span class="keyword">select</span>          仅查权限</span><br><span class="line"><span class="keyword">select</span>,<span class="keyword">insert</span>   查和插入权限</span><br><span class="line">usage                   无访问权限</span><br><span class="line"><span class="keyword">alter</span>                   使用<span class="keyword">alter</span> <span class="keyword">table</span></span><br><span class="line"><span class="keyword">alter</span> routine           使用<span class="keyword">alter</span> <span class="keyword">procedure</span>和<span class="keyword">drop</span> <span class="keyword">procedure</span></span><br><span class="line"><span class="keyword">create</span>                  使用<span class="keyword">create</span> <span class="keyword">table</span></span><br><span class="line"><span class="keyword">create</span> routine          使用<span class="keyword">create</span> <span class="keyword">procedure</span></span><br><span class="line"><span class="keyword">create</span> temporary tables 使用<span class="keyword">create</span> temporary tables</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">user</span>             使用<span class="keyword">create</span> <span class="keyword">user</span>、<span class="keyword">drop</span> <span class="keyword">user</span>、rename <span class="keyword">user</span>和<span class="keyword">revoke</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span>             使用<span class="keyword">create</span> <span class="keyword">view</span></span><br><span class="line"><span class="keyword">delete</span>                  使用<span class="keyword">delete</span></span><br><span class="line"><span class="keyword">drop</span>                    使用<span class="keyword">drop</span> <span class="keyword">table</span></span><br><span class="line"><span class="keyword">execute</span>                 使用<span class="keyword">call</span>和存储过程</span><br><span class="line">file                    使用<span class="keyword">select</span> <span class="keyword">into</span> outfile 和 load data infile</span><br><span class="line"><span class="keyword">grant</span> option            使用<span class="keyword">grant</span> 和 <span class="keyword">revoke</span></span><br><span class="line">index                   使用index</span><br><span class="line"><span class="keyword">insert</span>                  使用<span class="keyword">insert</span></span><br><span class="line">lock tables             使用lock <span class="keyword">table</span></span><br><span class="line">process                 使用<span class="keyword">show</span> <span class="keyword">full</span> processlist</span><br><span class="line"><span class="keyword">select</span>                  使用<span class="keyword">select</span></span><br><span class="line"><span class="keyword">show</span> databases          使用<span class="keyword">show</span> databases</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">view</span>               使用<span class="keyword">show</span> <span class="keyword">view</span></span><br><span class="line">update                  使用update</span><br><span class="line">reload                  使用flush</span><br><span class="line">shutdown                使用mysqladmin shutdown(关闭MySQL)</span><br><span class="line">super</span><br><span class="line">replication client      服务器位置的访问</span><br><span class="line">replication slave       由复制从属使用</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">对于目标数据库以及内部其他：</span><br><span class="line">    数据库名.<span class="operator">*</span>           数据库中的所有</span><br><span class="line">    数据库名.tb_name     指定数据库中的某张tb_name</span><br><span class="line">    数据库名.存储过程     指定数据库中的存储过程</span><br><span class="line">    <span class="operator">*</span>.<span class="operator">*</span>                  所有数据库</span><br><span class="line">    用户名<span class="variable">@IP</span>地址        用户只能在改IP下才能访问</span><br><span class="line">    用户名<span class="variable">@192</span><span class="number">.168</span><span class="number">.1</span>.<span class="operator">%</span>   用户只能在改IP段下才能访问(通配符<span class="operator">%</span>tb_name示任意)</span><br><span class="line">    用户名@<span class="operator">%</span>             用户可以再任意IP下访问(默认IP地址为<span class="operator">%</span>)</span><br></pre></td></tr></table></figure><h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h2><p>JOIN 按照功能大致分为如下三类：<br>INNER JOIN（内连接,或等值连接）：获取两个tb_name中字段匹配关系的记录。<br>LEFT JOIN（左连接）：获取左tb_name所有记录，即使右tb_name没有对应匹配的记录。<br>RIGHT JOIN（右连接）： 与 LEFT JOIN 相反，用于获取右tb_name所有记录，即使左tb_name没有对应匹配的记录。</p><p>select tb1.field1, tb1.field2,…tb2.fieldX FROM tb1 tb1_alias JOIN tb2 tb2_alias on tb1.special_field=tb2.special_field</p><p>MySQL 同样也支持其他正则tb_name达式的匹配， MySQL中使用 REGEXP 操作符来进行正则tb_name达式匹配</p><p>select field FROM tb_name WHERE condition REGEXP ‘pattern’;</p><p>select DISTINCT field FROM tb_name;</p><p>UPDATE tb_name SET field=new_value WHERE field=old_Value</p><ul><li><p>单tb_name查询</p></li><li><p>多tb_name查询</p></li><li><p>子查询</p></li><li><p>自然连接</p></li><li><p>内连接</p></li><li><p>外连接</p></li><li><p>自连接</p></li><li><p>左连接</p></li><li><p>右连接</p></li></ul><p>多tb_name查询：<br>连接：<br>交叉连接：笛卡尔乘积<br>自然连接(内连接)： 条件WHERE<br>外连接：<br>左外连接：… LEFT JOIN … ON …<br>右外连接: … RIGHT JOIN … ON …<br>自连接： 条件WHERE</p><p>子查询：<br>比较操作中使用子查询：子查询只能返回单个值；<br>IN(): 使用子查询；<br>在FROM中使用子查询；</p><p>联合查询：<br>UNION</p><p>关系运算：<br>投影：只输出指定属性<br>选择：只输出符合条件的行<br>自然连接：具有相同名字的属性上所有取值相同的行；<br>笛卡尔积(交叉连接)：<br>(a+b)*(c+d)=ac+ad+bc+bd<br>外连接<br>内连接<br>完全连接<br>并：集合运算</p><p>视图：<br>存储下来的select语句；<br>基于基tb_name的查询结果；</p><pre><code>物化视图：select 将select的结果保存下来，但是基tb_name更新了，物化视图就凉了

mysql视图上不能创建索引
</code></pre><h1 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h1><h2 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h2><p>创建用户的三种方式:</p><ul><li><p>create user user_name identified by ‘password’;</p></li><li><p>grant usage on <em>.</em> to username@’hostname’;</p></li><li><p>insert into mysql.user set password=password(“new password”) where user=’user_name’;</p></li></ul><h2 id="权限"><a href="#权限" class="headerlink" title="权限"></a>权限</h2><blockquote><p>重置数据库 root 密码</p></blockquote><p>启动mysqld_safe时传递两个参数：<br>–skip-grant-tables<br>–skip-networking</p><pre><code>通过更新授权tb_name方式(insert into mysql.user set password=password() where user=&#39;root&#39;)直接修改其密码，而后移除此两个选项重启服务器。
</code></pre><h1 id="建表规范"><a href="#建表规范" class="headerlink" title="建表规范"></a>建表规范</h1><p>– Normal Format, NF<br>- 每个表保存一个实体信息<br>- 每个具有一个ID字段作为主键<br>- ID主键 + 原子表<br>– 1NF, 第一范式<br>字段不能再分，就满足第一范式。<br>– 2NF, 第二范式<br>满足第一范式的前提下，不能出现部分依赖。<br>消除符合主键就可以避免部分依赖。增加单列关键字。<br>– 3NF, 第三范式<br>满足第二范式的前提下，不能出现传递依赖。<br>某个字段依赖于主键，而有其他字段依赖于该字段。这就是传递依赖。<br>将一个实体信息的数据放在一个表内实现。</p><h1 id="表维护"><a href="#表维护" class="headerlink" title="表维护"></a>表维护</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 分析和存储表的关键字分布</span><br><span class="line">ANALYZE [<span class="keyword">LOCAL</span> <span class="operator">|</span> NO_WRITE_TO_BINLOG] <span class="keyword">TABLE</span> 表名 ...</span><br><span class="line"># 检查一个或多个表是否有错误</span><br><span class="line"><span class="keyword">CHECK</span> <span class="keyword">TABLE</span> tbl_name [, tbl_name] ... [option] ...</span><br><span class="line">option <span class="operator">=</span> &#123;QUICK <span class="operator">|</span> FAST <span class="operator">|</span> MEDIUM <span class="operator">|</span> EXTENDED <span class="operator">|</span> CHANGED&#125;</span><br><span class="line"># 整理数据文件的碎片</span><br><span class="line">OPTIMIZE [<span class="keyword">LOCAL</span> <span class="operator">|</span> NO_WRITE_TO_BINLOG] <span class="keyword">TABLE</span> tbl_name [, tbl_name] ...</span><br></pre></td></tr></table></figure><h1 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h1><p>视图是一个虚拟表，其内容由查询定义。同真实的表一样，视图包含一系列带有名称的列和行数据。但是，视图并不在数据库中以存储的数据值集形式存在。行和列数据来自由定义视图的查询所引用的表，并且在引用视图时动态生成。<br>视图具有表结构文件，但不存在数据文件。<br>对其中所引用的基础表来说，视图的作用类似于筛选。定义视图的筛选可以来自当前或其它数据库的一个或多个表，或者其它视图。通过视图进行查询没有任何限制，通过它们进行数据修改时的限制也很少。<br>视图是存储在数据库中的查询的sql语句，它主要出于两种原因：安全原因，视图可以隐藏一些数据，如：社会保险基金表，可以用视图只显示姓名，地址，而不显示社会保险号和工资数等，另一原因是可使复杂的查询易于理解和使用。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建视图</span></span><br><span class="line"><span class="keyword">CREATE</span> [<span class="keyword">OR</span> REPLACE] [ALGORITHM <span class="operator">=</span> &#123;UNDEFINED <span class="operator">|</span> <span class="keyword">MERGE</span> <span class="operator">|</span> TEMPTABLE&#125;] <span class="keyword">VIEW</span> view_name [(column_list)] <span class="keyword">AS</span> select_statement</span><br><span class="line">    <span class="operator">-</span> 视图名必须唯一，同时不能与表重名。</span><br><span class="line">    <span class="operator">-</span> 视图可以使用<span class="keyword">select</span>语句查询到的列名，也可以自己指定相应的列名。</span><br><span class="line">    <span class="operator">-</span> 可以指定视图执行的算法，通过ALGORITHM指定。</span><br><span class="line">    <span class="operator">-</span> column_list如果存在，则数目必须等于<span class="keyword">SELECT</span>语句检索的列数</span><br><span class="line"><span class="comment">-- 查看结构</span></span><br><span class="line">    <span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> view_name</span><br><span class="line"><span class="comment">-- 删除视图</span></span><br><span class="line">    <span class="operator">-</span> 删除视图后，数据依然存在。</span><br><span class="line">    <span class="operator">-</span> 可同时删除多个视图。</span><br><span class="line">    <span class="keyword">DROP</span> <span class="keyword">VIEW</span> [IF <span class="keyword">EXISTS</span>] view_name ...</span><br><span class="line"><span class="comment">-- 修改视图结构</span></span><br><span class="line">    <span class="operator">-</span> 一般不修改视图，因为不是所有的更新视图都会映射到表上。</span><br><span class="line">    <span class="keyword">ALTER</span> <span class="keyword">VIEW</span> view_name [(column_list)] <span class="keyword">AS</span> select_statement</span><br><span class="line"><span class="comment">-- 视图作用</span></span><br><span class="line">    <span class="number">1.</span> 简化业务逻辑</span><br><span class="line">    <span class="number">2.</span> 对客户端隐藏真实的表结构</span><br><span class="line"><span class="comment">-- 视图算法(ALGORITHM)</span></span><br><span class="line">    <span class="keyword">MERGE</span>       合并</span><br><span class="line">        将视图的查询语句，与外部查询需要先合并再执行！</span><br><span class="line">    TEMPTABLE   临时表</span><br><span class="line">        将视图执行完毕后，形成临时表，再做外层查询！</span><br><span class="line">    UNDEFINED   未定义(默认)，指的是MySQL自主去选择相应的算法。</span><br></pre></td></tr></table></figure><h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><p>事务是指逻辑上的一组操作，组成这组操作的各个单元，要不全成功要不全失败。<br>- 支持连续SQL的集体成功或集体撤销。<br>- 事务是数据库在数据晚自习方面的一个功能。<br>- 需要利用 InnoDB 或 BDB 存储引擎，对自动提交的特性支持完成。<br>- InnoDB被称为事务安全型引擎。<br>– 事务开启<br>START TRANSACTION; 或者 BEGIN;<br>开启事务后，所有被执行的SQL语句均被认作当前事务内的SQL语句。<br>– 事务提交<br>COMMIT;<br>– 事务回滚<br>ROLLBACK;<br>如果部分操作发生问题，映射到事务开启前。<br>– 事务的特性<br>1. 原子性（Atomicity）<br>事务是一个不可分割的工作单位，事务中的操作要么都发生，要么都不发生。<br>2. 一致性（Consistency）<br>事务前后数据的完整性必须保持一致。<br>- 事务开始和结束时，外部数据一致<br>- 在整个事务过程中，操作是连续的<br>3. 隔离性（Isolation）<br>多个用户并发访问数据库时，一个用户的事务不能被其它用户的事物所干扰，多个并发事务之间的数据要相互隔离。<br>4. 持久性（Durability）<br>一个事务一旦被提交，它对数据库中的数据改变就是永久性的。<br>– 事务的实现<br>1. 要求是事务支持的表类型<br>2. 执行一组相关的操作前开启事务<br>3. 整组操作完成后，都成功，则提交；如果存在失败，选择回滚，则会回到事务开始的备份点。<br>– 事务的原理<br>利用InnoDB的自动提交(autocommit)特性完成。<br>普通的MySQL执行语句后，当前的数据提交操作均可被其他客户端可见。<br>而事务是暂时关闭“自动提交”机制，需要commit提交持久化数据操作。<br>– 注意<br>1. 数据定义语言（DDL）语句不能被回滚，比如创建或取消数据库的语句，和创建、取消或更改表或存储的子程序的语句。<br>2. 事务不能被嵌套<br>– 保存点<br>SAVEPOINT 保存点名称 – 设置一个事务保存点<br>ROLLBACK TO SAVEPOINT 保存点名称 – 回滚到保存点<br>RELEASE SAVEPOINT 保存点名称 – 删除保存点<br>– InnoDB自动提交特性设置<br>SET autocommit = 0|1; 0表示关闭自动提交，1表示开启自动提交。<br>- 如果关闭了，那普通操作的结果对其他客户端也不可见，需要commit提交后才能持久化数据操作。<br>- 也可以关闭自动提交来开启事务。但与START TRANSACTION不同的是，<br>SET autocommit是永久改变服务器的设置，直到下次再次修改该设置。(针对当前连接)<br>而START TRANSACTION记录开启前的状态，而一旦事务提交或回滚后就需要再次开启事务。(针对当前事务)</p><h1 id="备份"><a href="#备份" class="headerlink" title="备份"></a>备份</h1><p>MySQL的备份和还原</p><pre><code>备份：副本
RAID1，RAID10：保证硬件损坏而不会业务中止；
    DROP TABLE mydb.tb1;

备份类型：
    热备份、温备份和冷备份
        热备份：读、写不受影响；
        温备份：仅可以执行读操作；
        冷备份：离线备份；读、写操作均中止；

    物理备份和逻辑备份
        物理备份：复制数据文件；
        逻辑备份：将数据导出至文本文件中；

    完全备份、增量备份和差异备份；
        完全备份：备份全部数据；
        增量备份：仅备份上次完全备份或增量备份以后变化的数据；
        差异备份：仅备份上次完全备份以来变化的数据；

在线：物理完全备份
</code></pre><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">备份，将数据的结构与表内数据保存起来。</span><br><span class="line">利用 mysqldump 指令完成。</span><br><span class="line"># 导出</span><br><span class="line">mysqldump [options] db_name [tables]</span><br><span class="line">mysqldump [options] <span class="comment">---database DB1 [DB2 DB3...]</span></span><br><span class="line">mysqldump [options] <span class="comment">--all--database</span></span><br><span class="line"><span class="number">1.</span> 导出一张表</span><br><span class="line">　　mysqldump <span class="operator">-</span>u用户名 <span class="operator">-</span>p密码 库名 表名 <span class="operator">&gt;</span> 文件名(D:<span class="operator">/</span>a.sql)</span><br><span class="line"><span class="number">2.</span> 导出多张表</span><br><span class="line">　　mysqldump <span class="operator">-</span>u用户名 <span class="operator">-</span>p密码 库名 表<span class="number">1</span> 表<span class="number">2</span> 表<span class="number">3</span> <span class="operator">&gt;</span> 文件名(D:<span class="operator">/</span>a.sql)</span><br><span class="line"><span class="number">3.</span> 导出所有表</span><br><span class="line">　　mysqldump <span class="operator">-</span>u用户名 <span class="operator">-</span>p密码 库名 <span class="operator">&gt;</span> 文件名(D:<span class="operator">/</span>a.sql)</span><br><span class="line"><span class="number">4.</span> 导出一个库</span><br><span class="line">　　mysqldump <span class="operator">-</span>u用户名 <span class="operator">-</span>p密码 <span class="comment">--lock-all-tables --database 库名 &gt; 文件名(D:/a.sql)</span></span><br><span class="line">可以<span class="operator">-</span>w携带<span class="keyword">WHERE</span>条件</span><br><span class="line"><span class="comment">-- 导入</span></span><br><span class="line"><span class="number">1.</span> 在登录mysql的情况下：</span><br><span class="line">　　source  备份文件</span><br><span class="line"><span class="number">2.</span> 在不登录的情况下</span><br><span class="line">　　mysql <span class="operator">-</span>u用户名 <span class="operator">-</span>p密码 库名 <span class="operator">&lt;</span> 备份文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">into</span> outfile 文件地址 [控制格式] <span class="keyword">from</span> 表名;   <span class="comment">-- 导出表数据</span></span><br><span class="line"></span><br><span class="line">load data [<span class="keyword">local</span>] infile 文件地址 [replace<span class="operator">|</span>ignore] <span class="keyword">into</span> <span class="keyword">table</span> 表名 [控制格式]; <span class="comment">-- 导入数据</span></span><br><span class="line">    生成的数据默认的分隔符是制表符</span><br><span class="line">    <span class="keyword">local</span>未指定，则数据文件必须在服务器上</span><br><span class="line">    replace 和 ignore 关键词控制对现有的唯一键记录的重复的处理</span><br><span class="line"><span class="comment">-- 控制格式</span></span><br><span class="line">fields  控制字段格式</span><br><span class="line">默认：fields terminated <span class="keyword">by</span> <span class="string">&#x27;\t&#x27;</span> enclosed <span class="keyword">by</span> <span class="string">&#x27;&#x27;</span> escaped <span class="keyword">by</span> <span class="string">&#x27;\\&#x27;</span></span><br><span class="line">    terminated <span class="keyword">by</span> <span class="string">&#x27;string&#x27;</span>  <span class="comment">-- 终止</span></span><br><span class="line">    enclosed <span class="keyword">by</span> <span class="string">&#x27;char&#x27;</span>      <span class="comment">-- 包裹</span></span><br><span class="line">    escaped <span class="keyword">by</span> <span class="string">&#x27;char&#x27;</span>       <span class="comment">-- 转义</span></span><br><span class="line">    <span class="comment">-- 示例：</span></span><br><span class="line">        <span class="keyword">SELECT</span> a,b,a<span class="operator">+</span>b <span class="keyword">INTO</span> OUTFILE <span class="string">&#x27;/tmp/result.text&#x27;</span></span><br><span class="line">        FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;,&#x27;</span> OPTIONALLY ENCLOSED <span class="keyword">BY</span> <span class="string">&#x27;&quot;&#x27;</span></span><br><span class="line">        LINES TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">        <span class="keyword">FROM</span> test_table;</span><br><span class="line">lines   控制行格式</span><br><span class="line">默认：lines terminated <span class="keyword">by</span> <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">    terminated <span class="keyword">by</span> <span class="string">&#x27;string&#x27;</span>  <span class="comment">-- 终止</span></span><br></pre></td></tr></table></figure><h1 id="SQL编程"><a href="#SQL编程" class="headerlink" title="SQL编程"></a>SQL编程</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--// 局部变量 ----------</span></span><br><span class="line"><span class="comment">-- 变量声明</span></span><br><span class="line">    <span class="keyword">declare</span> var_name[,...] type [<span class="keyword">default</span> <span class="keyword">value</span>]</span><br><span class="line">    这个语句被用来声明局部变量。要给变量提供一个默认值，请包含一个<span class="keyword">default</span>子句。值可以被指定为一个表达式，不需要为一个常数。如果没有<span class="keyword">default</span>子句，初始值为<span class="keyword">null</span>。</span><br><span class="line"><span class="comment">-- 赋值</span></span><br><span class="line">    使用 <span class="keyword">set</span> 和 <span class="keyword">select</span> <span class="keyword">into</span> 语句为变量赋值。</span><br><span class="line">    <span class="operator">-</span> 注意：在函数内是可以使用全局变量（用户自定义的变量）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--// 全局变量 ----------</span></span><br><span class="line"><span class="comment">-- 定义、赋值</span></span><br><span class="line"><span class="keyword">set</span> 语句可以定义并为变量赋值。</span><br><span class="line"><span class="keyword">set</span> <span class="variable">@var</span> <span class="operator">=</span> <span class="keyword">value</span>;</span><br><span class="line">也可以使用<span class="keyword">select</span> <span class="keyword">into</span>语句为变量初始化并赋值。这样要求<span class="keyword">select</span>语句只能返回一行，但是可以是多个字段，就意味着同时为多个变量进行赋值，变量的数量需要与查询的列数一致。</span><br><span class="line">还可以把赋值语句看作一个表达式，通过<span class="keyword">select</span>执行完成。此时为了避免<span class="operator">=</span>被当作关系运算符看待，使用:<span class="operator">=</span>代替。（<span class="keyword">set</span>语句可以使用<span class="operator">=</span> 和 :<span class="operator">=</span>）。</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@var</span>:<span class="operator">=</span><span class="number">20</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="variable">@v1</span>:<span class="operator">=</span>id, <span class="variable">@v2</span><span class="operator">=</span>name <span class="keyword">from</span> t1 limit <span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> tbl_name <span class="keyword">where</span> <span class="variable">@var</span>:<span class="operator">=</span><span class="number">30</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">into</span> 可以将表中查询获得的数据赋给变量。</span><br><span class="line">    <span class="operator">-</span><span class="operator">|</span> <span class="keyword">select</span> <span class="built_in">max</span>(height) <span class="keyword">into</span> <span class="variable">@max</span>_height <span class="keyword">from</span> tb;</span><br><span class="line"><span class="comment">-- 自定义变量名</span></span><br><span class="line">为了避免<span class="keyword">select</span>语句中，用户自定义的变量与系统标识符（通常是字段名）冲突，用户自定义变量在变量名前使用@作为开始符号。</span><br><span class="line"><span class="variable">@var</span><span class="operator">=</span><span class="number">10</span>;</span><br><span class="line">    <span class="operator">-</span> 变量被定义后，在整个会话周期都有效（登录到退出）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--// 控制结构 ----------</span></span><br><span class="line"><span class="comment">-- if语句</span></span><br><span class="line">if search_condition <span class="keyword">then</span></span><br><span class="line">    statement_list   </span><br><span class="line">[elseif search_condition <span class="keyword">then</span></span><br><span class="line">    statement_list]</span><br><span class="line">...</span><br><span class="line">[<span class="keyword">else</span></span><br><span class="line">    statement_list]</span><br><span class="line"><span class="keyword">end</span> if;</span><br><span class="line"><span class="comment">-- case语句</span></span><br><span class="line"><span class="keyword">CASE</span> <span class="keyword">value</span> <span class="keyword">WHEN</span> [compare<span class="operator">-</span><span class="keyword">value</span>] <span class="keyword">THEN</span> <span class="keyword">result</span></span><br><span class="line">[<span class="keyword">WHEN</span> [compare<span class="operator">-</span><span class="keyword">value</span>] <span class="keyword">THEN</span> <span class="keyword">result</span> ...]</span><br><span class="line">[<span class="keyword">ELSE</span> <span class="keyword">result</span>]</span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"><span class="comment">-- while循环</span></span><br><span class="line">[begin_label:] while search_condition do</span><br><span class="line">    statement_list</span><br><span class="line"><span class="keyword">end</span> while [end_label];</span><br><span class="line"><span class="operator">-</span> 如果需要在循环内提前终止 while循环，则需要使用标签；标签需要成对出现。</span><br><span class="line">    <span class="comment">-- 退出循环</span></span><br><span class="line">        退出整个循环 leave</span><br><span class="line">        退出当前循环 iterate</span><br><span class="line">        通过退出的标签决定退出哪个循环</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">--// 内置函数 ----------</span></span><br><span class="line"><span class="comment">-- 数值函数</span></span><br><span class="line"><span class="built_in">abs</span>(x)          <span class="comment">-- 绝对值 abs(-10.9) = 10</span></span><br><span class="line">format(x, d)    <span class="comment">-- 格式化千分位数值 format(1234567.456, 2) = 1,234,567.46</span></span><br><span class="line"><span class="built_in">ceil</span>(x)         <span class="comment">-- 向上取整 ceil(10.1) = 11</span></span><br><span class="line"><span class="built_in">floor</span>(x)        <span class="comment">-- 向下取整 floor (10.1) = 10</span></span><br><span class="line">round(x)        <span class="comment">-- 四舍五入去整</span></span><br><span class="line"><span class="built_in">mod</span>(m, n)       <span class="comment">-- m%n m mod n 求余 10%3=1</span></span><br><span class="line">pi()            <span class="comment">-- 获得圆周率</span></span><br><span class="line">pow(m, n)       <span class="comment">-- m^n</span></span><br><span class="line"><span class="built_in">sqrt</span>(x)         <span class="comment">-- 算术平方根</span></span><br><span class="line">rand()          <span class="comment">-- 随机数</span></span><br><span class="line"><span class="keyword">truncate</span>(x, d)  <span class="comment">-- 截取d位小数</span></span><br><span class="line"><span class="comment">-- 时间日期函数</span></span><br><span class="line">now(), <span class="built_in">current_timestamp</span>();     <span class="comment">-- 当前日期时间</span></span><br><span class="line"><span class="built_in">current_date</span>();                 <span class="comment">-- 当前日期</span></span><br><span class="line"><span class="built_in">current_time</span>();                 <span class="comment">-- 当前时间</span></span><br><span class="line"><span class="type">date</span>(<span class="string">&#x27;yyyy-mm-dd hh:ii:ss&#x27;</span>);    <span class="comment">-- 获取日期部分</span></span><br><span class="line"><span class="type">time</span>(<span class="string">&#x27;yyyy-mm-dd hh:ii:ss&#x27;</span>);    <span class="comment">-- 获取时间部分</span></span><br><span class="line">date_format(<span class="string">&#x27;yyyy-mm-dd hh:ii:ss&#x27;</span>, <span class="string">&#x27;%d %y %a %d %m %b %j&#x27;</span>); <span class="comment">-- 格式化时间</span></span><br><span class="line">unix_timestamp();               <span class="comment">-- 获得unix时间戳</span></span><br><span class="line">from_unixtime();                <span class="comment">-- 从时间戳获得时间</span></span><br><span class="line"><span class="comment">-- 字符串函数</span></span><br><span class="line">length(string)          <span class="comment">-- string长度，字节</span></span><br><span class="line"><span class="keyword">char_length</span>(string)     <span class="comment">-- string的字符个数</span></span><br><span class="line"><span class="built_in">substring</span>(str, position [,length])      <span class="comment">-- 从str的position开始,取length个字符</span></span><br><span class="line">replace(str ,search_str ,replace_str)   <span class="comment">-- 在str中用replace_str替换search_str</span></span><br><span class="line">instr(string ,substring)    <span class="comment">-- 返回substring首次在string中出现的位置</span></span><br><span class="line">concat(string [,...])   <span class="comment">-- 连接字串</span></span><br><span class="line">charset(str)            <span class="comment">-- 返回字串字符集</span></span><br><span class="line">lcase(string)           <span class="comment">-- 转换成小写</span></span><br><span class="line"><span class="keyword">left</span>(string, length)    <span class="comment">-- 从string2中的左边起取length个字符</span></span><br><span class="line">load_file(file_name)    <span class="comment">-- 从文件读取内容</span></span><br><span class="line">locate(substring, string [,start_position]) <span class="comment">-- 同instr,但可指定开始位置</span></span><br><span class="line">lpad(string, length, pad)   <span class="comment">-- 重复用pad加在string开头,直到字串长度为length</span></span><br><span class="line">ltrim(string)           <span class="comment">-- 去除前端空格</span></span><br><span class="line">repeat(string, count)   <span class="comment">-- 重复count次</span></span><br><span class="line">rpad(string, length, pad)   <span class="comment">--在str后用pad补充,直到长度为length</span></span><br><span class="line">rtrim(string)           <span class="comment">-- 去除后端空格</span></span><br><span class="line">strcmp(string1 ,string2)    <span class="comment">-- 逐字符比较两字串大小</span></span><br><span class="line"><span class="comment">-- 流程函数</span></span><br><span class="line"><span class="keyword">case</span> <span class="keyword">when</span> [<span class="keyword">condition</span>] <span class="keyword">then</span> <span class="keyword">result</span> [<span class="keyword">when</span> [<span class="keyword">condition</span>] <span class="keyword">then</span> <span class="keyword">result</span> ...] [<span class="keyword">else</span> <span class="keyword">result</span>] <span class="keyword">end</span>   多分支</span><br><span class="line">if(expr1,expr2,expr3)  双分支。</span><br><span class="line"><span class="comment">-- 聚合函数</span></span><br><span class="line"><span class="built_in">count</span>()</span><br><span class="line"><span class="built_in">sum</span>();</span><br><span class="line"><span class="built_in">max</span>();</span><br><span class="line"><span class="built_in">min</span>();</span><br><span class="line"><span class="built_in">avg</span>();</span><br><span class="line">group_concat()</span><br><span class="line"><span class="comment">-- 其他常用函数</span></span><br><span class="line">md5();</span><br><span class="line"><span class="keyword">default</span>();</span><br><span class="line"><span class="comment">-- 字符连接函数</span></span><br><span class="line">concat(str1,str2,...])</span><br><span class="line">concat_ws(separator,str1,str2,...)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 分支语句</span></span><br><span class="line">if 条件 <span class="keyword">then</span></span><br><span class="line">    执行语句</span><br><span class="line">elseif 条件 <span class="keyword">then</span></span><br><span class="line">    执行语句</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    执行语句</span><br><span class="line"><span class="keyword">end</span> if;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改最外层语句结束符</span></span><br><span class="line">delimiter 自定义结束符号</span><br><span class="line">    <span class="keyword">SQL</span>语句</span><br><span class="line">自定义结束符号</span><br><span class="line">delimiter ;     <span class="comment">-- 修改回原来的分号</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 语句块包裹</span></span><br><span class="line"><span class="keyword">begin</span></span><br><span class="line">    语句块</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--// 存储函数，自定义函数 ----------</span></span><br><span class="line"><span class="comment">-- 新建</span></span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> function_name (参数列表) <span class="keyword">RETURNS</span> 返回值类型</span><br><span class="line">        函数体</span><br><span class="line">    <span class="operator">-</span> 函数名，应该合法的标识符，并且不应该与已有的关键字冲突。</span><br><span class="line">    <span class="operator">-</span> 一个函数应该属于某个数据库，可以使用db_name.funciton_name的形式执行当前函数所属数据库，否则为当前数据库。</span><br><span class="line">    <span class="operator">-</span> 参数部分，由&quot;参数名&quot;和&quot;参数类型&quot;组成。多个参数用逗号隔开。</span><br><span class="line">    <span class="operator">-</span> 函数体由多条可用的mysql语句，流程控制，变量声明等语句构成。</span><br><span class="line">    <span class="operator">-</span> 多条语句应该使用 begin...end 语句块包含。</span><br><span class="line">    <span class="operator">-</span> 一定要有 <span class="keyword">return</span> 返回值语句。</span><br><span class="line"><span class="comment">-- 删除</span></span><br><span class="line">    <span class="keyword">DROP</span> <span class="keyword">FUNCTION</span> [IF <span class="keyword">EXISTS</span>] function_name;</span><br><span class="line"><span class="comment">-- 查看</span></span><br><span class="line">    <span class="keyword">SHOW</span> <span class="keyword">FUNCTION</span> STATUS <span class="keyword">LIKE</span> <span class="string">&#x27;partten&#x27;</span></span><br><span class="line">    <span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> function_name;</span><br><span class="line"><span class="comment">-- 修改</span></span><br><span class="line">    <span class="keyword">ALTER</span> <span class="keyword">FUNCTION</span> function_name 函数选项</span><br><span class="line"></span><br><span class="line"><span class="comment">--// 存储过程，自定义功能 ----------</span></span><br><span class="line"><span class="comment">-- 定义</span></span><br><span class="line">存储存储过程 是一段代码（过程），存储在数据库中的<span class="keyword">sql</span>组成。</span><br><span class="line">一个存储过程通常用于完成一段业务逻辑，例如报名，交班费，订单入库等。</span><br><span class="line">而一个函数通常专注与某个功能，视为其他程序服务的，需要在其他语句中调用函数才可以，而存储过程不能被其他调用，是自己执行 通过<span class="keyword">call</span>执行。</span><br><span class="line"><span class="comment">-- 创建</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> sp_name (参数列表)</span><br><span class="line">    过程体</span><br><span class="line">参数列表：不同于函数的参数列表，需要指明参数类型</span><br><span class="line"><span class="keyword">IN</span>，表示输入型</span><br><span class="line"><span class="keyword">OUT</span>，表示输出型</span><br><span class="line"><span class="keyword">INOUT</span>，表示混合型</span><br><span class="line">注意，没有返回值。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 存储过程 */</span> <span class="comment">------------------</span></span><br><span class="line">存储过程是一段可执行性代码的集合。相比函数，更偏向于业务逻辑。</span><br><span class="line">调用：<span class="keyword">CALL</span> 过程名</span><br><span class="line"><span class="comment">-- 注意</span></span><br><span class="line"><span class="operator">-</span> 没有返回值。</span><br><span class="line"><span class="operator">-</span> 只能单独调用，不可夹杂在其他语句中</span><br><span class="line"><span class="comment">-- 参数</span></span><br><span class="line"><span class="keyword">IN</span><span class="operator">|</span><span class="keyword">OUT</span><span class="operator">|</span><span class="keyword">INOUT</span> 参数名 数据类型</span><br><span class="line"><span class="keyword">IN</span>      输入：在调用过程中，将数据输入到过程体内部的参数</span><br><span class="line"><span class="keyword">OUT</span>     输出：在调用过程中，将过程体处理完的结果返回到客户端</span><br><span class="line"><span class="keyword">INOUT</span>   输入输出：既可输入，也可输出</span><br><span class="line"><span class="comment">-- 语法</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> 过程名 (参数列表)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    过程体</span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><div class="article-footer"><blockquote class="mt-2x"><ul class="post-copyright list-unstyled"><li class="post-copyright-link hidden-xs"><strong>本文链接：</strong> <a href="http://jsunnyr.github.io/2020/01/07/mysql-basic/" title="mysql_basic" target="_blank" rel="external">http://jsunnyr.github.io/2020/01/07/mysql-basic/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！</li></ul></blockquote><div class="panel panel-default panel-badger"><div class="panel-body"><figure class="media"><div class="media-left"><a href="https://github.com/jsunnyr" target="_blank" class="img-burn thumb-sm visible-lg"><img src="/images/avatar.jpg" class="img-rounded w-full" alt=""></a></div><div class="media-body"><h3 class="media-heading"><a href="https://github.com/jsunnyr" target="_blank"><span class="text-dark">素丶素丶丶</span><small class="ml-1x">wodetian</small></a></h3><div>忍一时越想越气，退一步越想越亏。</div></div></figure></div></div></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2020/01/07/mysql-basic-os-related/" title="mysql_basic_os_related"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;Newer</span></a></li><li class="next"><a href="/2020/01/06/os-basic-01/" title="OS_basic_01"><span>Older&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>$</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>Maybe you could buy me a cup of coffee.</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="alipay"><div class="donate-payimg"><img src="/images/donate/yy.png" alt="Scan Qrcode" title="Scan"></div><p class="text-muted mv">Scan this qrcode</p><p class="text-grey">Open alipay app scan this qrcode, buy me a coffee!</p></div><div role="tabpanel" class="tab-pane fade" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/xx.png" alt="Scan Qrcode" title="Scan"></div><p class="text-muted mv">Scan this qrcode</p><p class="text-grey">Open wechat app scan this qrcode, buy me a coffee!</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> alipay</a></li><li role="presentation"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> wechat payment</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/jsunnyr" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li><li><a href="http://weibo.com/jsunnyr" target="_blank" title="Weibo" data-toggle="tooltip" data-placement="top"><i class="icon icon-weibo"></i></a></li><li><a href="https://twitter.com/iwebued" target="_blank" title="Twitter" data-toggle="tooltip" data-placement="top"><i class="icon icon-twitter"></i></a></li><li><a href="https://www.behance.net/jsunnyr" target="_blank" title="Behance" data-toggle="tooltip" data-placement="top"><i class="icon icon-behance"></i></a></li><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul><div class="copyright"><div class="publishby">Theme by <a href="https://github.com/cofess" target="_blank">cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.</div></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"",appKey:"",placeholder:"Just go go",avatar:"mm",meta:meta,pageSize:"10",visitor:!1})</script></body></html>